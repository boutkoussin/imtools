<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">    <!--This HTML was auto-generated from MATLAB code.To make changes, update the MATLAB code and republish this document.      -->    <title>READENVIROI - Read ENVI files.</title>    <meta name="generator" content="MATLAB 7.14">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2012-11-14">    <meta name="DC.source" content="readenviroi.m">    <style type="text/css">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}html { min-height:100%; margin-bottom:1px; }html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }html body td { vertical-align:top; text-align:left; }h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }a { color:#005fce; text-decoration:none; }a:hover { color:#005fce; text-decoration:underline; }a:visited { color:#004aa0; text-decoration:none; }p { padding:0px; margin:0px 0px 20px; }img { padding:0px; margin:0px 0px 20px; border:none; }p img, pre img, tt img, li img { margin-bottom:0px; } ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }ul li { padding:0px; margin:0px 0px 7px 0px; }ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }ul li ol li { list-style:decimal; }ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }ol li ol li { list-style-type:lower-alpha; }ol li ul { padding-top:7px; }ol li ul li { list-style:square; }.content { font-size:1.2em; line-height:140%; padding: 20px; }pre, tt, code { font-size:12px; }pre { margin:0px 0px 20px; }pre.error { color:red; }pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }span.keyword { color:#0000FF }span.comment { color:#228B22 }span.string { color:#A020F0 }span.untermstring { color:#B20000 }span.syscmd { color:#B28C00 }.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }.footer p { margin:0px; }  </style>  </head>  <body>    <div class="content">      <h1>READENVIROI - Read ENVI files.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Description</a></li>          <li><a href="#2">Syntax</a></li>          <li><a href="#3">Output</a></li>          <li><a href="#4">Remark</a></li>          <li><a href="#5">Acknowledgment</a></li>          <li><a href="#7">See also</a></li>          <li><a href="#8">Function implementation</a></li>        </ul>      </div>      <h2>Description<a name="1"></a></h2>      <p>This function reads in an ENVI ROI file and outputs a Struct containing</p>      <pre class="language-matlab">ROI <span class="string">Name:</span>         <spanclass="string">ROI.'ROI Number'.'Name'</span>     <spanclass="string">(Char)</span>ROI <span class="string">Color:</span>        <span class="string">ROI.'ROI Number'.'Color'</span>    <spanclass="string">(vector)</span>ROI <span class="string">Num</span> <span class="string">Points:</span>   <spanclass="string">ROI.'ROI Number'.numPoints</span>  <spanclass="string">(scalar)</span>ROI <span class="string">Data:</span>         <span class="string">ROI.'ROI Number'.Points</span>     <spanclass="string">(matrix)</span></pre>      <h2>Syntax<a name="2"></a></h2>      <pre>   ROI = READENVIROI(roiFile);</pre>      <h2>Output<a name="3"></a></h2>      <p><b><tt>ROI</tt></b> : the data in each cell of the struct is as        outlined above. the matrix is of size # of bands plus the ID number, and        (X,Y) coordinates by the number of points in the <tt>ROI</tt>.</p>      <h2>Remark<a name="4"></a></h2>      <p>Note that this function assumes a strict formatting standard for the        ROI file. IT IS DESIGNED TO ONLY WORK ON THE ENVI ROI FILES SAVED IN        ASCII FORMAT. The ROI points must follow immediately after the last ROI        information line in the file top matter. There is a commented out while        loop that was intended to test for the start of the ROI points, but was        removed for convience. However, a more robust algorithm will test for        the start of the ROI points so as to avoid strict formatting errors.        Future improvements to this code may incorporate reading additional ROI        file formats and/or the test for teh start of the roi points.</p>      <h2>Acknowledgment<a name="5"></a></h2>      <p>Written by Jared Herweg, Rochester Institute of Technology, May 2010 <a          href="mailto:jxh6389@rit.edu">jxh6389@rit.edu</a></p>      <h2>See also<a name="7"></a></h2>      <p>Ressembles: <a href="readenviraster.html"><tt>READENVIRASTER</tt></a>.</p>      <pre class="codeinput"><span class="comment">% Redistribution and use in source and binary forms, with or without</span><span class="comment">% modification, are permitted provided that the following conditions are</span><span class="comment">% met:</span><span class="comment">%   - Redistributions of source code must retain the above copyright</span><span class="comment">%     notice, this list of conditions and the following disclaimer.</span><span class="comment">%   - Redistributions in binary form must reproduce the above copyright</span><span class="comment">%     notice, this list of conditions and the following disclaimer in the</span><span class="comment">%     documentation and/or other materials provided with the distribution.</span><span class="comment">%   - Neither the name of Rochester Institute of Technology nor the names</span><span class="comment">%     of its contributors may be used to endorse or promote products</span><span class="comment">%     derived from this software without specific prior written permission.</span><span class="comment">%</span><span class="comment">% Disclamer</span><span class="comment">% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS</span><span class="comment">% IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,</span><span class="comment">% THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</span><span class="comment">% PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR</span><span class="comment">% CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span><span class="comment">% EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span><span class="comment">% PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</span><span class="comment">% PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span><span class="comment">% LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span><span class="comment">% NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span><span class="comment">% SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></pre>      <h2>Function implementation<a name="8"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> ROI = readenviroi(roiFile)</pre>      <p>open File</p>      <pre class="codeinput">fid = fopen(roiFile);</pre>      <p>get ROI header information</p>      <pre class="codeinput">ROI = <span class="string">''</span>; <span class="comment">% Initialize Struct</span>test = [];<span class="keyword">while</span> isempty(test)    fline = fgetl(fid);    <span class="comment">% find number of ROIs</span>     test = find(strncmp(<span class="string">'; Number of'</span>, fline, 11));    <span class="comment">% test = strmatch('; Number of',fline);</span><span class="keyword">end</span>ROI.(<span class="string">'NumROI'</span>) = str2double(strtrim(fline(strfind(fline,<spanclass="string">':'</span>)+1:end)));test = [];</pre>      <p>for each ROI, get associated info</p>      <pre class="codeinput"><span class="keyword">for</span> count = 1:ROI.NumROI    <span class="keyword">while</span> isempty(test)        fline = fgetl(fid);        test = find(strncmp(<span class="string">'; ROI name'</span>, fline, 10));       <span class="comment">% test = strmatch('; ROI name',fline);</span>    <span class="keyword">end</span>    ROIName = strtrim(fline(strfind(fline,<span class="string">':'</span>)+1:end));    fline = fgetl(fid);    ROIcolor = str2double(strtrim(fline(strfind(fline,<span class="string">'{'</span>)+1:end-1)));    fline = fgetl(fid);    ROI_numPts = strtrim(fline(strfind(fline,<span class="string">':'</span>)+1:end));    <span class="comment">% Dynamically expand struct and assign ROI information to cell</span>    <span class="comment">% fields</span>    ROIcnt = [<span class="string">'R'</span> num2str(count)]; <span class="comment">% Each independent ROI name assigned</span>    ROI.(ROIcnt).(<span class="string">'Name'</span>) = ROIName;    ROI.(ROIcnt).(<span class="string">'Color'</span>) = ROIcolor;    ROI.(ROIcnt).(<span class="string">'numPts'</span>) = str2double(ROI_numPts);    test = [];<span class="keyword">end</span></pre>      <p>get the ROI Points for each ROI</p>      <pre class="codeinput"><span class="comment">% Advance to the start of the ROI points</span><span class="comment">%     while isempty(test)</span>fline = fgetl(fid);<span class="comment">%         test = strmatch(';   ID',fline);</span><span class="comment">%     end</span></pre>      <p>get number of bands in ROI</p>      <pre class="codeinput">NumBands = length(find(fline == <span class="string">'B'</span>));</pre>      <p>add 3 fields to num bands to account for ROI point ID and the x,y        coordinates (see ROI ASCII file).</p>      <pre class="codeinput">NumBands = NumBands + 3;</pre>      <p>for each ROI, get the associative ROI points</p>      <pre class="codeinput"><span class="keyword">for</span> count = 1:ROI.NumROI    ROIcnt = [<span class="string">'R'</span> num2str(count)];    ROI.(ROIcnt).(<span class="string">'Points'</span>) = zeros(ROI.(ROIcnt).numPts,NumBands);    <span class="keyword">for</span> count2 = 1:ROI.(ROIcnt).numPts        fline = fgetl(fid);        ROI.(ROIcnt).Points(count2,:) = str2double(fline);    <span class="keyword">end</span>    <span class="comment">% fline = fgetl(fid); % skips the blank line</span><span class="keyword">end</span></pre>      <p>close ROI File</p>      <pre class="codeinput">fclose(fid);</pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of readenviroi</span></pre>    </div>    <!--##### SOURCE BEGIN #####%% READENVIROI - Read ENVI files.%%% Description% This function reads in an ENVI ROI file and outputs a Struct containing%%   ROI Name:         ROI.'ROI Number'.'Name'     (Char)%   ROI Color:        ROI.'ROI Number'.'Color'    (vector)%   ROI Num Points:   ROI.'ROI Number'.numPoints  (scalar)%   ROI Data:         ROI.'ROI Number'.Points     (matrix)%%% Syntax %     ROI = READENVIROI(roiFile);%%% Output% *|ROI|* : the data in each cell of the struct is as outlined above. the matrix%      is of size # of bands plus the ID number, and (X,Y) coordinates by the%      number of points in the |ROI|.%%% Remark% Note that this function assumes a strict formatting standard for the ROI% file.  IT IS DESIGNED TO ONLY WORK ON THE ENVI ROI FILES SAVED IN ASCII % FORMAT.  The ROI points must follow immediately after the last ROI% information line in the file top matter.  There is a commented out while% loop that was intended to test for the start of the ROI points, but was% removed for convience.  However, a more robust algorithm will test for% the start of the ROI points so as to avoid strict formatting errors.% Future improvements to this code may incorporate reading additional ROI % file formats and/or the test for teh start of the roi points.%%% Acknowledgment% Written by Jared Herweg, Rochester Institute of Technology, May 2010% jxh6389@rit.edu%%% Contact% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also % Ressembles:% <readenviraster.html |READENVIRASTER|>.% Redistribution and use in source and binary forms, with or without % modification, are permitted provided that the following conditions are % met: %   - Redistributions of source code must retain the above copyright %     notice, this list of conditions and the following disclaimer. %   - Redistributions in binary form must reproduce the above copyright %     notice, this list of conditions and the following disclaimer in the %     documentation and/or other materials provided with the distribution.%   - Neither the name of Rochester Institute of Technology nor the names %     of its contributors may be used to endorse or promote products %     derived from this software without specific prior written permission.% % Disclamer % THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS % IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,% THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR % PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR % CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, % EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, % PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR % PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF % LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING % NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS % SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.%% Function implementationfunction ROI = readenviroi(roiFile)%%% open Filefid = fopen(roiFile);%%% get ROI header informationROI = ''; % Initialize Structtest = [];while isempty(test)    fline = fgetl(fid);    % find number of ROIs     test = find(strncmp('; Number of', fline, 11));    % test = strmatch('; Number of',fline); endROI.('NumROI') = str2double(strtrim(fline(strfind(fline,':')+1:end)));test = [];%%% for each ROI, get associated infofor count = 1:ROI.NumROI    while isempty(test)        fline = fgetl(fid);        test = find(strncmp('; ROI name', fline, 10));       % test = strmatch('; ROI name',fline);    end    ROIName = strtrim(fline(strfind(fline,':')+1:end));    fline = fgetl(fid);    ROIcolor = str2double(strtrim(fline(strfind(fline,'{')+1:end-1)));    fline = fgetl(fid);    ROI_numPts = strtrim(fline(strfind(fline,':')+1:end));    % Dynamically expand struct and assign ROI information to cell    % fields    ROIcnt = ['R' num2str(count)]; % Each independent ROI name assigned    ROI.(ROIcnt).('Name') = ROIName;    ROI.(ROIcnt).('Color') = ROIcolor;    ROI.(ROIcnt).('numPts') = str2double(ROI_numPts);    test = [];end%%% get the ROI Points for each ROI% Advance to the start of the ROI points%     while isempty(test)fline = fgetl(fid);%         test = strmatch(';   ID',fline);%     end%%% get number of bands in ROINumBands = length(find(fline == 'B'));%%% add 3 fields to num bands to account for ROI point ID and the% x,y coordinates (see ROI ASCII file).NumBands = NumBands + 3;%%% for each ROI, get the associative ROI pointsfor count = 1:ROI.NumROI    ROIcnt = ['R' num2str(count)];    ROI.(ROIcnt).('Points') = zeros(ROI.(ROIcnt).numPts,NumBands);    for count2 = 1:ROI.(ROIcnt).numPts        fline = fgetl(fid);        ROI.(ROIcnt).Points(count2,:) = str2double(fline);    end    % fline = fgetl(fid); % skips the blank lineend%%% close ROI Filefclose(fid);end % end of readenviroi##### SOURCE END #####--></body></html>