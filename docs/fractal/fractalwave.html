<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta content="text/html; charset=utf-8" http-equiv="content-type">    <!--This HTML was auto-generated from MATLAB code.To make changes, update the MATLAB code and republish this document.      -->    <title>fractalwave</title>    <meta name="generator" content="MATLAB 7.14">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2012-11-14">    <meta name="DC.source" content="fractalwave.m">    <style type="text/css">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}html { min-height:100%; margin-bottom:1px; }html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }html body td { vertical-align:top; text-align:left; }h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }a { color:#005fce; text-decoration:none; }a:hover { color:#005fce; text-decoration:underline; }a:visited { color:#004aa0; text-decoration:none; }p { padding:0px; margin:0px 0px 20px; }img { padding:0px; margin:0px 0px 20px; border:none; }p img, pre img, tt img, li img { margin-bottom:0px; } ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }ul li { padding:0px; margin:0px 0px 7px 0px; }ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }ul li ol li { list-style:decimal; }ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }ol li ol li { list-style-type:lower-alpha; }ol li ul { padding-top:7px; }ol li ul li { list-style:square; }.content { font-size:1.2em; line-height:140%; padding: 20px; }pre, tt, code { font-size:12px; }pre { margin:0px 0px 20px; }pre.error { color:red; }pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }span.keyword { color:#0000FF }span.comment { color:#228B22 }span.string { color:#A020F0 }span.untermstring { color:#B20000 }span.syscmd { color:#B28C00 }.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }.footer p { margin:0px; }  </style>  </head>  <body>    <div class="content">      <h2>Contents</h2>      <div>        <ul>          <li><a href="#3">Parsing parameters</a></li>          <li><a href="#4">Checking/setting parameters</a></li>          <li><a href="#5">Compute the multifractal decomposition</a></li>          <li><a href="#6">Display</a></li>        </ul>      </div>      <pre class="codeinput"><span class="keyword">function</span> [S, varargout] = fractalwave(I, varargin)</pre>      <pre class="codeinput"><span class="comment">% FRACTALWAVE.</span><span class="comment">%</span><span class="comment">%      S = FRACTALWAVE(I);</span><span class="comment">%      S = FRACTALWAVE(I, measure, rho);</span><span class="comment">%      [S, Histoh, H, H_r, DH, ErrDh, edges, scales, Tpsi, R ] = ...</span><span class="comment">%         FRACTALWAVE(I, measure, rho, 'Property', propertyvalue, ... );</span><span class="comment">%</span><span class="comment">% Inputs:</span><span class="comment">%   I :</span><span class="comment">%   measure :  default: =;</span><span class="comment">%   rho :  default: rho=[];</span><span class="comment">%</span><span class="comment">% Property [propertyname  propertyvalues]</span><span class="comment">%   'sc0' :  default: sc0=1;</span><span class="comment">%   'scw' :  default: scw=16;</span><span class="comment">%   'scr' :  default: scr=10;</span><span class="comment">%   'scn' :  default: scn=7;</span><span class="comment">%   'hmin' :  default: hmin=-1;</span><span class="comment">%   'hmax' :  default: hmax=2;</span><span class="comment">%   'hstep' :  default: hstep=100;</span><span class="comment">%   'hcorr' :  default: hcorr=0.999;</span><span class="comment">%   'sig' :  default: sig=0;</span><span class="comment">%   'der' :  default: der='fast';</span><span class="comment">%   'int' :  default: int='fast';</span><span class="comment">%   'samp' :  default: samp=1;</span><span class="comment">%   'tn' :  default: tn=false;</span><span class="comment">%   'gn' :  default: gn=false;</span><span class="comment">%</span><span class="comment">% Outputs:</span><span class="comment">%   S :</span><span class="comment">%   Histoh :</span><span class="comment">%   H :</span><span class="comment">%   H_r :</span><span class="comment">%   DH :</span><span class="comment">%   ErrDh :</span><span class="comment">%   scales :</span><span class="comment">%   edges :</span><span class="comment">%   Tpsi :</span><span class="comment">%   R :</span><span class="comment">%</span><span class="comment">% See also</span><span class="comment">% Ressembles: FRACTALWAVESTAT, FRACTALMORPH --</span><span class="comment">% Requires: FRACTALWAVE_BASE.</span></pre>      <h2>Parsing parameters<a name="3"></a></h2>      <pre class="codeinput">error(nargchk(1, 37, nargin, <span class="string">'struct'</span>));error(nargoutchk(0, 10, nargout, <span class="string">'struct'</span>));<span class="comment">% mandatory parameter</span><span class="keyword">if</span> ~isnumeric(I)    error(<span class="string">'fractalwave:inputerror'</span>,<span class="string">'a matrix is required in input'</span>);<span class="keyword">end</span><span class="comment">% optional parameters</span>p = createParser(<span class="string">'FRACTALWAVE'</span>);<span class="comment">% additional parameters regarding numerical estimation</span>p.addOptional(<span class="string">'measure'</span>, <span class="string">'tens'</span>, @(x)ischar(x) &amp;&amp; <spanclass="keyword">...</span>    any(strcmpi(x,{<span class="string">'grad'</span>,<span class="string">'scalar'</span>,<spanclass="string">'decorr'</span>,<spanclass="string">'tens'</span>,<spanclass="string">'riemann'</span>,<spanclass="string">'corr'</span>})));<span class="comment">% principal scale parameters</span>p.addOptional(<span class="string">'rho'</span>, [], @(x)isfloat(x) &amp;&amp; length(x)&gt;=1 &amp;&amp; any(x)&gt;=0);<span class="comment">% options for multiscale analysis</span>p.addParamValue(<span class="string">'sc0'</span>, 1, @(x)isscalar(x) &amp;&amp; x&gt;0);  <spanclass="comment">% output.sc0</span>p.addParamValue(<span class="string">'scw'</span>, 16, @(x)isscalar(x) &amp;&amp; x&gt;0); <spanclass="comment">% SC_W[0][0]</span>p.addParamValue(<span class="string">'scr'</span>, 10, @(x)isscalar(x) &amp;&amp; x&gt;0); <spanclass="comment">% WAV_RANGE</span>p.addParamValue(<span class="string">'scn'</span>, 7, @(x)isscalar(x) &amp;&amp; x&gt;1);  <spanclass="comment">% WPOINTS</span><span class="comment">% minimum and maximum singularity values considered in the histogram</span>p.addParamValue(<span class="string">'hmin'</span>, -1, @(x)isscalar(x) &amp;&amp; isfloat(x) &amp;&amp; x&lt;=0);p.addParamValue(<span class="string">'hmax'</span>, 2, @(x)isscalar(x) &amp;&amp; isfloat(x) &amp;&amp; x&gt;=0 );p.addParamValue(<span class="string">'hstep'</span>, 100, @(x)isscalar(x) &amp;&amp; <spanclass="keyword">...</span>    (isfloat(x) &amp;&amp; x&gt;0 &amp;&amp; x&lt;=1) || (x&gt;1 &amp;&amp; round(x)==x));<span class="comment">% goodness for singularity analysis regression</span>p.addParamValue(<span class="string">'hcorr'</span>, 0.999, @(x)isscalar(x) &amp;&amp; isfloat(x) &amp;&amp; x&gt;=0 &amp;&amp; x&lt;=1);<span class="comment">% options for estimating the GST</span>p.addParamValue(<span class="string">'sig'</span>, 0, @(x)isscalar(x) &amp;&amp; isfloat(x) &amp;&amp; x&gt;=0);p.addParamValue(<span class="string">'der'</span>, <span class="string">'fast'</span>, @(x)islogical(x) || (ischar(x) &amp;&amp; <spanclass="keyword">...</span>    any(strcmpi(x,{<span class="string">'matlab'</span>,<span class="string">'vista'</span>,<spanclass="string">'fast'</span>,<spanclass="string">'conv'</span>,<spanclass="string">'fleck'</span>, <spanclass="keyword">...</span>    <span class="string">'tap5'</span>,<span class="string">'tap7'</span>,<spanclass="string">'sob'</span>,<spanclass="string">'opt'</span>,<spanclass="string">'ana'</span>}))));p.addParamValue(<span class="string">'int'</span>, <span class="string">'fast'</span>, @(x)islogical(x) || (ischar(x) &amp;&amp; <spanclass="keyword">...</span>    any(strcmpi(x,{<span class="string">'matlab'</span>,<span class="string">'conv'</span>,<spanclass="string">'fast'</span>,<spanclass="string">'ani'</span>}))));p.addParamValue(<span class="string">'samp'</span>, 1, @(x)isscalar(x) &amp;&amp; round(x)==x &amp;&amp; x&gt;=1 &amp;&amp; x&lt;=5);p.addParamValue(<span class="string">'gn'</span>, false, @(x)islogical(x));p.addParamValue(<span class="string">'tn'</span>, false, @(x)islogical(x));<span class="comment">% windex = 0</span><span class="comment">% ord_der = 0</span><span class="comment">% sc0 [0][0] = 1</span><span class="comment">% sw [0][0] = 16</span><span class="comment">% wavrange = 10</span><span class="comment">% wavpoints = 7</span><span class="comment">% scale_wavelet = sw / max(x,y)</span><span class="comment">% qs = wavrange^(1/(wavpoints-1))</span><span class="comment">% (sc=1, ip=0; ip&lt;=wavpoints; ip++, sc=sc*qs)</span><span class="comment">% xx = 1 / log(sc * sc0)</span><span class="comment">% generate_wavelet_normalize at scale sc</span><span class="comment">% convolve(T)</span><span class="comment">% yy = log(abs(T))</span><span class="comment">% yy *= xx</span><span class="comment">% log(T) = log(alpha) + h*log(r)</span><span class="comment">% parse and validate all input arguments</span>p.parse(varargin{:});p = getvarParser(p);</pre>      <h2>Checking/setting parameters<a name="4"></a></h2>      <pre class="codeinput">[X,Y,C] = size(I);<span class="comment">%n_x = X*Y;</span></pre>      <h2>Compute the multifractal decomposition<a name="5"></a></h2>      <pre class="codeinput">[S, Histoh, H, H_r, DH, ErrDh, scales, edges, Tpsi, R] = <spanclass="keyword">...</span>    fractalwave_base(I, p.measure, p.rho, p.sc0, p.scw, p.scr, p.scn, <span class="keyword">...</span>    p.hmin, p.hmax, p.hstep, p.sig, p.der, p.int, p.samp, p.gn, p.tn);<span class="comment">% note: the last element of scales is sc0</span><span class="keyword">if</span> nargout&gt;=2, varargout{1} = Histoh;    <span class="keyword">if</span> nargout&gt;=3, varargout{2} = H;        <span class="keyword">if</span> nargout&gt;=4, varargout{3} = H_r;            <span class="keyword">if</span> nargout&gt;=5, varargout{4} = DH;                <span class="keyword">if</span> nargout&gt;=6,  varargout{5} = ErrDh;                    <span class="keyword">if</span> nargout&gt;=7, varargout{6} = scales;                        <span class="keyword">if</span> nargout&gt;=8, varargout{7} = edges;                            <span class="keyword">if</span> nargout&gt;=9,  varargout{8} = Tpsi;                                <span class="keyword">if</span> nargout==10,  varargout{9} = R;  <spanclass="keyword">end</span>                            <span class="keyword">end</span>                        <span class="keyword">end</span>                    <span class="keyword">end</span>                <span class="keyword">end</span>            <span class="keyword">end</span>        <span class="keyword">end</span>    <span class="keyword">end</span><span class="keyword">end</span></pre>      <h2>Display<a name="6"></a></h2>      <pre class="codeinput"><span class="keyword">if</span> p.disp    ndisp = 3; mdisp = ceil((length(scales)-1)/ndisp);    <span class="comment">% we distinguish the cases 'riemann' and 'scalar'</span>    <span class="keyword">if</span> C&gt;1 &amp;&amp; any(strcmp(p.measure,{<spanclass="string">'grad'</span>,<spanclass="string">'scalar'</span>,<spanclass="string">'decorr'</span>}))        n_x = numel(S{1});        <span class="keyword">for</span> c=1:C            <span class="comment">% display the wavelet transform</span>            figure <span class="comment">% open a display window</span>            <span class="keyword">for</span> r=1:length(scales)-1                subplot(mdisp, ndisp, r),  imagesc(rescale(Tpsi{c}(:,:,r))),                colormap <span class="string">gray</span>, title([<span class="string">'WT at \sigma='</span> num2str(scales(r))])            <span class="keyword">end</span>            S{c}(S{c}&gt;p.hmax) = p.hmax;            h0 = min(S{c}(:));     h1 = max(S{c}(:));            <span class="comment">%delta_h = 0.01;      range_h = (h1 - h0) / delta_h;</span>            <span class="comment">% output range of singularities</span>            disp_sing = [<span class="string">'Singularity range for channel '</span> num2str(c)];            disp([disp_sing <span class="string">': [ '</span> num2str(h0) <spanclass="string">' - '</span> num2str(h1) <spanclass="string">' ]'</span>]);            figure, <span class="comment">% open another window</span>            <span class="comment">% display the singularity exponents</span>            title_sing = [<span class="string">'singularity exponents for channel '</span> num2str(c)];            subplot(1,2,1), imagesc(S{c}), axis <span class="string">image</span> <spanclass="string">off</span>, colormap <spanclass="string">gray</span>,            title(title_sing);            <span class="comment">% output regression rate</span>            disp_reg = [<span class="string">'Good regression points for channel '</span> num2str(c)];            disp([disp_reg <span class="string">': '</span> num2str(100*sum(abs(R{c}(:))&gt;=p.hcorr)/n_x) <spanclass="string">' %'</span>]);            subplot(1,2,2),imagesc(abs(R{c})&gt;=p.hcorr), axis <span class="string">image</span> <spanclass="string">off</span>, colormap <spanclass="string">gray</span>,            title(<span class="string">'''good regression'' map'</span>);            <span class="comment">% display its histogram</span>            title_exp = [<span class="string">'exponents distribution for channel '</span> num2str(c)];            figure, bar(edges,Histoh{c},<span class="string">'histc'</span>), <spanclass="comment">% hist(S{c}(:),range_h)</span>            title(title_exp)            title_spec = [<span class="string">'multifractal spectrum for channel '</span> num2str(c)];            figure, errorbar(H_r{c}, DH{c}, ErrDh{c}/2, ErrDh{c}/2), title(title_spec);        <span class="keyword">end</span>    <span class="keyword">else</span>        n_x = numel(S);        figure;        <span class="keyword">for</span> r=1:length(scales)-1            subplot(mdisp, ndisp, r),  imagesc(rescale(Tpsi(:,:,r))),            colormap <span class="string">gray</span>, title([<span class="string">'WT at \sigma='</span> num2str(scales(r))]);        <span class="keyword">end</span>        S(S&gt;p.hmax) = p.hmax;        h0 = min(S(:));    h1 = max(S(:));        disp([<span class="string">'Singularity range: [ '</span> num2str(h0) <spanclass="string">' - '</span> num2str(h1) <spanclass="string">' ]'</span>]);        figure, subplot(1,2,1), imagesc(S), axis <span class="string">image</span> <spanclass="string">off</span>, colormap <spanclass="string">gray</span>,        title(<span class="string">'singularity exponents'</span>);        disp([<span class="string">'Good regression points: '</span> <span class="keyword">...</span>            num2str(100*sum(abs(R(:))&gt;=p.hcorr) / n_x) <span class="string">' %'</span>]);        subplot(1,2,2), imagesc(abs(R)&gt;=p.hcorr), axis <span class="string">image</span> <spanclass="string">off</span>, colormap <spanclass="string">gray</span>,        title(<span class="string">'''good regression'' map'</span>);        figure, bar(edges,Histoh,<span class="string">'histc'</span>), title(<spanclass="string">'exponents distribution'</span>);        figure, errorbar(H_r, DH, ErrDh/2, ErrDh/2), title(<span class="string">'multifractal spectrum'</span>);    <span class="keyword">end</span><span class="keyword">end</span></pre>      <pre class="codeinput"><span class="keyword">end</span></pre></div>    <!--##### SOURCE BEGIN #####function [S, varargout] = fractalwave(I, varargin)% FRACTALWAVE.% %      S = FRACTALWAVE(I);%      S = FRACTALWAVE(I, measure, rho);%      [S, Histoh, H, H_r, DH, ErrDh, edges, scales, Tpsi, R ] = ... %         FRACTALWAVE(I, measure, rho, 'Property', propertyvalue, ... );%% Inputs:%   I :%   measure :  default: =; %   rho :  default: rho=[];% % Property [propertyname  propertyvalues]%   'sc0' :  default: sc0=1;%   'scw' :  default: scw=16;%   'scr' :  default: scr=10;%   'scn' :  default: scn=7;%   'hmin' :  default: hmin=-1;%   'hmax' :  default: hmax=2;%   'hstep' :  default: hstep=100;%   'hcorr' :  default: hcorr=0.999;%   'sig' :  default: sig=0;%   'der' :  default: der='fast';%   'int' :  default: int='fast';%   'samp' :  default: samp=1;%   'tn' :  default: tn=false;%   'gn' :  default: gn=false;%% Outputs:%   S :%   Histoh :%   H :%   H_r :%   DH :%   ErrDh :%   scales :%   edges :%   Tpsi :%   R :%   % credit: J.Grazzini (ISR-2/LANL)%% See also % Ressembles: FRACTALWAVESTAT, FRACTALMORPH REPLACE_WITH_DASH_DASH% Requires: FRACTALWAVE_BASE.%% Parsing parameterserror(nargchk(1, 37, nargin, 'struct'));error(nargoutchk(0, 10, nargout, 'struct'));% mandatory parameterif ~isnumeric(I)    error('fractalwave:inputerror','a matrix is required in input'); end% optional parametersp = createParser('FRACTALWAVE');   % additional parameters regarding numerical estimationp.addOptional('measure', 'tens', @(x)ischar(x) && ...    any(strcmpi(x,{'grad','scalar','decorr','tens','riemann','corr'})));% principal scale parametersp.addOptional('rho', [], @(x)isfloat(x) && length(x)>=1 && any(x)>=0);% options for multiscale analysisp.addParamValue('sc0', 1, @(x)isscalar(x) && x>0);  % output.sc0p.addParamValue('scw', 16, @(x)isscalar(x) && x>0); % SC_W[0][0]p.addParamValue('scr', 10, @(x)isscalar(x) && x>0); % WAV_RANGEp.addParamValue('scn', 7, @(x)isscalar(x) && x>1);  % WPOINTS% minimum and maximum singularity values considered in the histogramp.addParamValue('hmin', -1, @(x)isscalar(x) && isfloat(x) && x<=0);p.addParamValue('hmax', 2, @(x)isscalar(x) && isfloat(x) && x>=0 );p.addParamValue('hstep', 100, @(x)isscalar(x) && ...    (isfloat(x) && x>0 && x<=1) || (x>1 && round(x)==x));% goodness for singularity analysis regressionp.addParamValue('hcorr', 0.999, @(x)isscalar(x) && isfloat(x) && x>=0 && x<=1);% options for estimating the GSTp.addParamValue('sig', 0, @(x)isscalar(x) && isfloat(x) && x>=0);p.addParamValue('der', 'fast', @(x)islogical(x) || (ischar(x) && ...    any(strcmpi(x,{'matlab','vista','fast','conv','fleck', ...    'tap5','tap7','sob','opt','ana'}))));p.addParamValue('int', 'fast', @(x)islogical(x) || (ischar(x) && ...    any(strcmpi(x,{'matlab','conv','fast','ani'}))));p.addParamValue('samp', 1, @(x)isscalar(x) && round(x)==x && x>=1 && x<=5);p.addParamValue('gn', false, @(x)islogical(x));p.addParamValue('tn', false, @(x)islogical(x));% windex = 0% ord_der = 0% sc0 [0][0] = 1% sw [0][0] = 16% wavrange = 10% wavpoints = 7% scale_wavelet = sw / max(x,y)% qs = wavrange^(1/(wavpoints-1))% (sc=1, ip=0; ip<=wavpoints; ip++, sc=sc*qs)% xx = 1 / log(sc * sc0)% generate_wavelet_normalize at scale sc% convolve(T)% yy = log(abs(T))% yy *= xx% log(T) = log(alpha) + h*log(r)% parse and validate all input argumentsp.parse(varargin{:}); p = getvarParser(p);                                                            %% Checking/setting parameters[X,Y,C] = size(I);%n_x = X*Y;%% Compute the multifractal decomposition[S, Histoh, H, H_r, DH, ErrDh, scales, edges, Tpsi, R] = ...    fractalwave_base(I, p.measure, p.rho, p.sc0, p.scw, p.scr, p.scn, ...    p.hmin, p.hmax, p.hstep, p.sig, p.der, p.int, p.samp, p.gn, p.tn);% note: the last element of scales is sc0if nargout>=2, varargout{1} = Histoh;    if nargout>=3, varargout{2} = H;        if nargout>=4, varargout{3} = H_r;            if nargout>=5, varargout{4} = DH;                if nargout>=6,  varargout{5} = ErrDh;                    if nargout>=7, varargout{6} = scales;                        if nargout>=8, varargout{7} = edges;                            if nargout>=9,  varargout{8} = Tpsi;                                if nargout==10,  varargout{9} = R;  end                            end                        end                    end                end            end        end    endend%% Displayif p.disp            ndisp = 3; mdisp = ceil((length(scales)-1)/ndisp);        % we distinguish the cases 'riemann' and 'scalar'    if C>1 && any(strcmp(p.measure,{'grad','scalar','decorr'}))        n_x = numel(S{1});        for c=1:C            % display the wavelet transform            figure % open a display window            for r=1:length(scales)-1                subplot(mdisp, ndisp, r),  imagesc(rescale(Tpsi{c}(:,:,r))),                colormap gray, title(['WT at \sigma=' num2str(scales(r))])            end            S{c}(S{c}>p.hmax) = p.hmax;            h0 = min(S{c}(:));     h1 = max(S{c}(:));            %delta_h = 0.01;      range_h = (h1 - h0) / delta_h;            % output range of singularities            disp_sing = ['Singularity range for channel ' num2str(c)];            disp([disp_sing ': [ ' num2str(h0) ' - ' num2str(h1) ' ]']);            figure, % open another window            % display the singularity exponents            title_sing = ['singularity exponents for channel ' num2str(c)];            subplot(1,2,1), imagesc(S{c}), axis image off, colormap gray,            title(title_sing);            % output regression rate            disp_reg = ['Good regression points for channel ' num2str(c)];            disp([disp_reg ': ' num2str(100*sum(abs(R{c}(:))>=p.hcorr)/n_x) ' %']);            subplot(1,2,2),imagesc(abs(R{c})>=p.hcorr), axis image off, colormap gray,            title('''good regression'' map');            % display its histogram            title_exp = ['exponents distribution for channel ' num2str(c)];                  figure, bar(edges,Histoh{c},'histc'), % hist(S{c}(:),range_h)            title(title_exp)            title_spec = ['multifractal spectrum for channel ' num2str(c)];            figure, errorbar(H_r{c}, DH{c}, ErrDh{c}/2, ErrDh{c}/2), title(title_spec);        end            else        n_x = numel(S);        figure;        for r=1:length(scales)-1            subplot(mdisp, ndisp, r),  imagesc(rescale(Tpsi(:,:,r))),            colormap gray, title(['WT at \sigma=' num2str(scales(r))]);        end        S(S>p.hmax) = p.hmax;        h0 = min(S(:));    h1 = max(S(:));        disp(['Singularity range: [ ' num2str(h0) ' - ' num2str(h1) ' ]']);        figure, subplot(1,2,1), imagesc(S), axis image off, colormap gray,         title('singularity exponents');        disp(['Good regression points: ' ...            num2str(100*sum(abs(R(:))>=p.hcorr) / n_x) ' %']);        subplot(1,2,2), imagesc(abs(R)>=p.hcorr), axis image off, colormap gray,        title('''good regression'' map');        figure, bar(edges,Histoh,'histc'), title('exponents distribution');        figure, errorbar(H_r, DH, ErrDh/2, ErrDh/2), title('multifractal spectrum');    endendend##### SOURCE END #####-->  </body></html>