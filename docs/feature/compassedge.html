<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <title>COMPASSEDGE - Compass edge detection.</title>    <meta name="generator" content="MATLAB 7.11">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2011-07-08">    <meta name="DC.source" content="compassedge.m">    <style type="text/css">body {  background-color: white;  margin:10px;}h1 {  color: #990000;   font-size: x-large;}h2 {  color: #990000;  font-size: medium;}/* Make the text shrink to fit narrow windows, but not stretch too far in wide windows. */ p,h1,h2,div.content div {  max-width: 600px;  /* Hack for IE6 */  width: auto !important; width: 600px;}pre.codeinput {  background: #EEEEEE;  padding: 10px;}@media print {  pre.codeinput {word-wrap:break-word; width:100%;}} span.keyword {color: #0000FF}span.comment {color: #228B22}span.string {color: #A020F0}span.untermstring {color: #B20000}span.syscmd {color: #B28C00}pre.codeoutput {  color: #666666;  padding: 10px;}pre.error {  color: red;}p.footer {  text-align: right;  font-size: xx-small;  font-weight: lighter;  font-style: italic;  color: gray;}  </style>  </head>  <body>    <div class="content">      <h1>COMPASSEDGE - Compass edge detection.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Description</a></li>          <li><a href="#2">Algorithm</a></li>          <li><a href="#3">Syntax</a></li>          <li><a href="#4">Inputs</a></li>          <li><a href="#5">Property [propertyname propertyvalues]</a></li>          <li><a href="#6">Outputs</a></li>          <li><a href="#7">References</a></li>          <li><a href="#8">Acknowledgment</a></li>          <li><a href="#9">Contact</a></li>          <li><a href="#10">See also</a></li>          <li><a href="#11">Function implementation</a></li>        </ul>      </div>      <h2>Description<a name="1"></a></h2>      <p>Nothing else than a wrapper for the Generalized Compass        Operator for images [RT99a,RT99b,RT01], which contains various        information related to edges and corners in an image. See source        code [COMPASS] by Ruzon &amp; Tomasi.</p>      <h2>Algorithm<a name="2"></a></h2>      <p>The compass operator uses a circular window centered at a        junction where 4 pixel squares meet. The needle is a diameter at        a given orientation. The color distributions of the two        semicircles are computed, and the distance between them is        measured using the Earth Mover's Distance (EMD). The maximum EMD        over all orientations gives the edge strength and orientation at        that point.</p>      <h2>Syntax<a name="3"></a></h2>      <pre>   [S, O, A, U] = COMPASSEDGE(I);   [S, O, A, U] = COMPASSEDGE(I, sigma, 'Property', propertyvalue, ...);</pre>      <h2>Inputs<a name="4"></a></h2>      <p><b><tt>I</tt></b> : input image, possibly multichannel, with        size <tt>(X,Y,C)</tt>; when the variable <tt>'gray'</tt> (see        below) is set to true, then the function <tt>GREYCOMPASS_MEX</tt>        is applied over the different channels of the input image (even        in the case <tt>C=3</tt> channels); when <tt>'gray'</tt> is        set to false and <tt>C=3</tt> channels, the function <tt>COMPASS_MEX</tt>        is used: if <tt>I</tt> is of class <tt>uint8</tt>, the values        are treated as RGB values, if <tt>I</tt> is of class double,        the values are assumed to be in the CIE-Lab color space.</p>      <p><b><tt>sigma</tt></b> : (optional) scalar defining the standard        deviation of the Gaussian used to weight pixels in the Compass        Operator (operator's radius is <tt>3*R</tt>); default: <tt>sigma=1</tt>.</p>      <h2>Property [propertyname propertyvalues]<a name="5"></a></h2>      <p><b><tt>'gray'</tt></b> : (optional) logical value set to true        when the channels of the image <tt>I</tt> are treated        independently using <tt>GREYCOMPASS_MEX</tt>, even in the case        <tt>C=3</tt>; default: <tt>gray=false</tt>, ie. if <tt>C=3</tt>,        the function <tt>COMPASS_MEX</tt> is applied, <tt>GREYCOMPASS_MEX</tt>        is still applied for all other <tt>C</tt> values.</p>      <p><b><tt>'angles'</tt></b> : (optional) angles subtended by the        Generalized Compass Operator; if <tt>angles</tt> is a vector,        the Compass Operator will detect corners and edges at different        angles, and the output arguments will have multiple rows;        default: <tt>angles=180</tt> (edges only).</p>      <p><b><tt>'nwedges'</tt></b> : (optional) number of wedges        (orientations) in one-quarter of the circle; <tt>nwedges</tt>        defines the set of possible orientations and angles, so the        values in the <tt>angles</tt> vector must match; default: <tt>nwedges=6</tt>        (<tt>90/6 = 15</tt> degree increments).</p>      <h2>Outputs<a name="6"></a></h2>      <p><b><tt>S</tt></b> : strength of the Compass Operator, lying in        the interval <tt>[0,1]</tt>.</p>      <p><b><tt>O</tt></b> : orientation of the edge or corner, in        degrees; for edge detection, this number lies in <tt>[0,180)</tt>        and is measured with respect to the positive X-axis; for        corners, the interval is <tt>[0,360)</tt> and refers to the        orientation of the "right" side of the corner.</p>      <p><b><tt>A</tt></b> : the Abnormality of the Compass Operator at        that point; this is the minimum value over all orientations.</p>      <p><b><tt>U</tt></b> : the Uncertainty of the Compass Operator;        this is the number of degrees over which, at each orientation,        the compass operator gives similar responses.</p>      <h2>References<a name="7"></a></h2>      <p>[RT99a] M. Ruzon and C. Tomasi: "Color edge detection with the        Compass Operator", Proc. IEEE CVPR, vol. 2, pp. 160-166, 1999. <a          href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=784624">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=784624</a></p>      <p>[RT99b] M. Ruzon and C. Tomasi: "Corner detection in textured        color images", Proc. ICCV, vol. 2, pp. 1039-1045, 1999. <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=790384">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=790384</a></p>      <p>[RT01] M. Ruzon and C. Tomasi: "Edge, junction, and corner        detection using color distributions", IEEE Transactions on        Pattern Analysis and Machine Intelligence, 23(11):1281-1295,        2001. <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=969118">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=969118</a></p>      <p>[COMPASS] code available at <a href="http://ai.stanford.edu/%7Eruzon/compass/">http://ai.stanford.edu/~ruzon/compass/</a>.</p>      <h2>Acknowledgment<a name="8"></a></h2>      <p>This function calls the mex functions implemented in the        original [COMPASS] code by Ruzon &amp; Tomasi.</p>      <h2>See also<a name="10"></a></h2>      <p>Related: <a href="EDGECORNER.html"><tt>EDGECORNER</tt></a>, <a          href="CANNYEDGE.html"><tt>CANNYEDGE</tt></a>,        <a href="CANNYEDGEPROD.html"><tt>CANNYEDGEPROD</tt></a>, <a href="ROTHWELLEDGE.html"><tt>ROTHWELLEDGE</tt></a>,        <a href="CONGRUENCYEDGE.html"><tt>CONGRUENCYEDGE</tt></a>, <a href="SDGDEDGE.html"><tt>SDGDEDGE</tt></a>,        <a href="ANISOEDGE.html"><tt>ANISOEDGE</tt></a>, <a href="ELDERZUCKEREDGE.html"><tt>ELDERZUCKEREDGE</tt></a>,        <a href="KOETHEDGE.html"><tt>KOETHEDGE</tt></a>, <a href="PETROUEDGE.html"><tt>PETROUEDGE</tt></a>.        Called: <a href="COMPASSEDGE_BASE.html"><tt>COMPASSEDGE_BASE</tt></a>.</p>      <h2>Function implementation<a name="11"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> [S, O, A, U] = compassedge(I, varargin)</pre>      <p>parsing parameters</p>      <pre class="codeinput">error(nargchk(1, 16, nargin, <span class="string">'struct'</span>));error(nargoutchk(1, 4, nargout, <span class="string">'struct'</span>));<span class="keyword">if</span> ~isnumeric(I)    error(<span class="string">'cannyedge:inputparameter'</span>,<span class="string">'a matrix is required in input'</span>);<span class="keyword">end</span>p = createParser(<span class="string">'COMPASSEDGE'</span>);p.addOptional(<span class="string">'sigma'</span>, 1, @(x)isscalar(x) &amp;&amp; x&gt;=0.05);p.addParamValue(<span class="string">'angles'</span>, 180, @(x) (isscalar(x) || isvector(x)) &amp;&amp; <spanclass="keyword">...</span>    all(x&gt;=0 &amp; x&lt;=360));p.addParamValue(<span class="string">'nwedges'</span>, 6, @(x)isscalar(x) &amp; x&gt;=1);p.addParamValue(<span class="string">'gray'</span>, false, @(x)islogical(x));<span class="comment">% parse and validate all input arguments</span>p.parse(varargin{:});p = getvarParser(p);</pre>      <p>calculation</p>      <pre class="codeinput">[S, O, A, U] = compassedge_base(I, p.sigma, p.angles, p.nwedges, p.gray);</pre>      <p>display</p>      <pre class="codeinput"><span class="keyword">if</span> p.disp    figure, imagesc(S), axis <span class="string">image</span> <span class="string">off</span>, title(<spanclass="string">'compass strenght'</span>);    <span class="keyword">if</span> size(S,3)==1;  colormap <span class="string">gray</span>;  <spanclass="keyword">end</span><span class="keyword">end</span></pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of compassedge</span></pre> </div>    <!--##### SOURCE BEGIN #####%% COMPASSEDGE - Compass edge detection.%%% Description% Nothing else than a wrapper for the Generalized Compass Operator for images% [RT99a,RT99b,RT01], which contains various information related to edges% and corners in an image.% See source code [COMPASS] by Ruzon & Tomasi.%%% Algorithm% The compass operator uses a circular window centered at a junction where% 4 pixel squares meet. The needle is a diameter at a given orientation. The% color distributions of the two semicircles are computed, and the distance% between them is measured using the Earth Mover's Distance (EMD). The % maximum EMD over all orientations gives the edge strength and orientation% at that point. % %% Syntax%     [S, O, A, U] = COMPASSEDGE(I);%     [S, O, A, U] = COMPASSEDGE(I, sigma, 'Property', propertyvalue, ...);%%% Inputs%      % *|I|* : input image, possibly multichannel, with size |(X,Y,C)|; when the %     variable |'gray'| (see below) is set to true, then the function%     |GREYCOMPASS_MEX| is applied over the different channels of the input%     image (even in the case |C=3| channels); when |'gray'| is set to false%     and |C=3| channels, the function |COMPASS_MEX| is used: if |I| is of class%     |uint8|, the values are treated as RGB values, if |I| is of class double,%     the values are assumed to be in the CIE-Lab color space. %      % *|sigma|* : (optional) scalar defining the standard deviation of the Gaussian%     used to weight pixels in the Compass Operator (operator's radius is%     |3*R|); default: |sigma=1|. %%% Property [propertyname  propertyvalues]% *|'gray'|* : (optional) logical value set to true when the channels of the%     image |I| are treated independently using |GREYCOMPASS_MEX|, even in the%     case |C=3|; default: |gray=false|, ie. if |C=3|, the function |COMPASS_MEX|%     is applied, |GREYCOMPASS_MEX| is still applied for all other |C| values.%      % *|'angles'|* : (optional) angles subtended by the Generalized Compass%     Operator; if |angles| is a vector, the Compass Operator will detect%     corners and edges at different angles, and the output arguments will%     have multiple rows; default: |angles=180| (edges only).%      % *|'nwedges'|* : (optional) number of wedges (orientations) in one-quarter%     of the circle; |nwedges| defines the set of possible orientations and%     angles, so the values in the |angles| vector must match; default: %     |nwedges=6| (|90/6 = 15| degree increments).%%% Outputs% *|S|* : strength of the Compass Operator, lying in the interval |[0,1]|.%      % *|O|* : orientation of the edge or corner, in degrees;  for edge detection,%     this number lies in |[0,180)| and is measured with respect to the%     positive X-axis; for corners, the interval is |[0,360)| and refers to%     the orientation of the "right" side of the corner.%      % *|A|* : the Abnormality of the Compass Operator at that point; this is the%     minimum value over all orientations.%      % *|U|* : the Uncertainty of the Compass Operator; this is the number of%     degrees over which, at each orientation, the compass operator gives%     similar responses.%%% References% [RT99a]  M. Ruzon and C. Tomasi: "Color edge detection with the Compass %      Operator", Proc. IEEE CVPR, vol. 2, pp. 160-166, 1999. %      <http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=784624>%      % [RT99b]  M. Ruzon and C. Tomasi: "Corner detection in textured color %      images", Proc. ICCV, vol. 2, pp. 1039-1045, 1999.%      <http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=790384>%% [RT01]  M. Ruzon and C. Tomasi: "Edge, junction, and corner detection%      using color distributions",  IEEE Transactions on Pattern Analysis%      and Machine Intelligence, 23(11):1281-1295, 2001. %      <http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=969118>% % [COMPASS] code available at <http://ai.stanford.edu/~ruzon/compass/>.%%% Acknowledgment% This function calls the mex functions implemented in the original [COMPASS]% code by Ruzon & Tomasi.%%% Contact% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also% Related:% <EDGECORNER.html |EDGECORNER|>,% <CANNYEDGE.html |CANNYEDGE|>,% <CANNYEDGEPROD.html |CANNYEDGEPROD|>,% <ROTHWELLEDGE.html |ROTHWELLEDGE|>,% <CONGRUENCYEDGE.html |CONGRUENCYEDGE|>,% <SDGDEDGE.html |SDGDEDGE|>,% <ANISOEDGE.html |ANISOEDGE|>,% <ELDERZUCKEREDGE.html |ELDERZUCKEREDGE|>,% <KOETHEDGE.html |KOETHEDGE|>,% <PETROUEDGE.html |PETROUEDGE|>.% Called:% <COMPASSEDGE_BASE.html |COMPASSEDGE_BASE|>.%% Function implementationfunction [S, O, A, U] = compassedge(I, varargin)%%% parsing parameterserror(nargchk(1, 16, nargin, 'struct'));error(nargoutchk(1, 4, nargout, 'struct'));if ~isnumeric(I)    error('cannyedge:inputparameter','a matrix is required in input'); endp = createParser('COMPASSEDGE');   p.addOptional('sigma', 1, @(x)isscalar(x) && x>=0.05);p.addParamValue('angles', 180, @(x) (isscalar(x) || isvector(x)) && ...    all(x>=0 & x<=360));p.addParamValue('nwedges', 6, @(x)isscalar(x) & x>=1);p.addParamValue('gray', false, @(x)islogical(x));% parse and validate all input argumentsp.parse(varargin{:}); p = getvarParser(p);                                                            %%% calculation[S, O, A, U] = compassedge_base(I, p.sigma, p.angles, p.nwedges, p.gray);%%% displayif p.disp    figure, imagesc(S), axis image off, title('compass strenght');    if size(S,3)==1;  colormap gray;  endendend % end of compassedge##### SOURCE END #####-->  </body></html>