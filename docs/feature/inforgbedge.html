<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <title>INFORGBEDGE - Visualization of edge magnitude and orientation      of color images.</title>    <meta name="generator" content="MATLAB 7.11">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2011-07-08">    <meta name="DC.source" content="inforgbedge.m">    <style type="text/css">body {  background-color: white;  margin:10px;}h1 {  color: #990000;   font-size: x-large;}h2 {  color: #990000;  font-size: medium;}/* Make the text shrink to fit narrow windows, but not stretch too far in wide windows. */ p,h1,h2,div.content div {  max-width: 600px;  /* Hack for IE6 */  width: auto !important; width: 600px;}pre.codeinput {  background: #EEEEEE;  padding: 10px;}@media print {  pre.codeinput {word-wrap:break-word; width:100%;}} span.keyword {color: #0000FF}span.comment {color: #228B22}span.string {color: #A020F0}span.untermstring {color: #B20000}span.syscmd {color: #B28C00}pre.codeoutput {  color: #666666;  padding: 10px;}pre.error {  color: red;}p.footer {  text-align: right;  font-size: xx-small;  font-weight: lighter;  font-style: italic;  color: gray;}  </style>  </head>  <body>    <div class="content">      <h1>INFORGBEDGE - Visualization of edge magnitude and orientation        of color images.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Description</a></li>          <li><a href="#2">Syntax</a></li>          <li><a href="#3">Inputs</a></li>          <li><a href="#4">Outputs</a></li>          <li><a href="#5">Credit</a></li>          <li><a href="#6">See also</a></li>          <li><a href="#7">Function implementation</a></li>        </ul>      </div>      <h2>Description<a name="1"></a></h2>      <p>Provide edge magnitude and orientation of multispectral images        based on their derivatives, using multichannel approach        (gradient structure tensor), and reduced (RGB or LAB) approach        (gradient). Used for simple visual comparison of both        approaches.</p>      <h2>Syntax<a name="2"></a></h2>      <pre>   [E, M, O, rE, rM, rO] = INFORGBEDGE(I, 'disp', true);   [E, M, O, rE, rM, rO] = INFORGBEDGE(I, reduce, rho, sig, der, int);</pre>      <h2>Inputs<a name="3"></a></h2>      <p><b><tt>I</tt></b> : an input image with size <tt>(X,Y,C)</tt>,        where <tt>C=3</tt> when <tt>I</tt> is multichannel.</p>      <p><b><tt>reduce</tt></b> : optional string setting the method        used for reducing the input image into a scalar (graylevel) one;        it is either <tt>'rgb'</tt> for calling <tt>RGB2GRAY</tt> or <tt>'lab'</tt>        for calling <tt>RGB2LAB</tt>; default: <tt>reduce='rgb'</tt>.</p>      <p><b><tt>rho</tt></b> : optional integration scale (see <tt>GTSMOOTH</tt>);

        default: <tt>rho=0</tt>, ie. in order to compare both        multichannel and reduced approaches, we skip in principle the        spatial averaging of the tensor.</p>      <p><b><tt>sig</tt></b> : optional differentiation scale (see <tt>GTSMOOTH</tt>);

        default: <tt>sig=1</tt>, i.e. Gaussian regularisation is used        for estimating the derivatives.</p>      <p><b><tt>der</tt></b> : optional string for        pre-smoothing/differentiation (see <tt>GRDSMOOTH</tt>): <tt>'matlab'</tt>,        <tt>'vista'</tt>, <tt>'fast'</tt>, <tt>'conv'</tt>, <tt>'fleck'</tt>,        <tt>'tap5'</tt>, <tt>'tap7'</tt>, <tt>'sob'</tt>, <tt>'opt'</tt>        or <tt>'ana'</tt>; default: <tt>der='matlab'</tt>.</p>      <p><b><tt>int</tt></b> : optional string for post-smoothing (see <tt>GRD2GST</tt>):

        <tt>'matlab'</tt>, <tt>'conv'</tt> or <tt>'fast'</tt>;        default: <tt>int='fast'</tt>.</p>      <h2>Outputs<a name="4"></a></h2>      <p><b><tt>E, rE</tt></b> : edge maps obtained through multichannel        and reduced approaches.</p>      <p><b><tt>M, O</tt></b> : magnitude and orientation using the        multichannel approach.</p>      <p><b><tt>rM, rO</tt></b> : ibid reducing the image first.</p>      <p>Displays the overlapped gradient magnitudes and edge maps of a        color image using both multispectral and reduced approaches.</p>      <h2>See also<a name="6"></a></h2>      <p>Related: <a href="EDGECORNER.html"><tt>EDGECORNER</tt></a>, <a          href="KOETHEDGE.html"><tt>KOETHEDGE</tt></a>,        <a href="CANNYEDGE.html"><tt>CANNYEDGE</tt></a>. Called: <a href="INFORGBEDGE_BASE.html"><tt>INFORGBEDGE_BASE</tt></a>.</p>      <h2>Function implementation<a name="7"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> [E, M, O, rE, rM, rO] = inforgbedge(I, varargin)</pre>      <p>parsing parameters</p>      <pre class="codeinput">error(nargchk(1, 19, nargin, <span class="string">'struct'</span>));error(nargoutchk(0, 4, nargout, <span class="string">'struct'</span>));<span class="comment">% mandatory parameter</span><span class="keyword">if</span> ~isnumeric(I)    error(<span class="string">'gstsmooth:inputerror'</span>,<span class="string">'a matrix is required in input'</span>);<span class="keyword">end</span><span class="comment">% optional parameters</span>p = createParser(<span class="string">'GSTSMOOTH'</span>);<span class="comment">% principal optional parameters</span>p.addOptional(<span class="string">'reduce'</span>, <span class="string">'rgb'</span>, @(x)ischar(x) &amp;&amp; any(strcmpi(x,{<spanclass="string">'rgb'</span>,<spanclass="string">'lab'</span>})));p.addOptional(<span class="string">'rho'</span>, 0, @(x)isscalar(x) &amp;&amp; isfloat(x) &amp;&amp; x&gt;=0);p.addOptional(<span class="string">'sigma'</span>, 1, @(x)isscalar(x) &amp;&amp; isfloat(x) &amp;&amp; x&gt;=0);p.addOptional(<span class="string">'der'</span>, <span class="string">'matlab'</span>, @(x)islogical(x) || (ischar(x) &amp;&amp; <spanclass="keyword">...</span>    any(strcmpi(x,{<span class="string">'matlab'</span>,<span class="string">'vista'</span>,<spanclass="string">'fast'</span>,<spanclass="string">'conv'</span>,<spanclass="string">'fleck'</span>, <spanclass="keyword">...</span>    <span class="string">'tap5'</span>,<span class="string">'tap7'</span>,<spanclass="string">'sob'</span>,<spanclass="string">'opt'</span>,<spanclass="string">'ana'</span>}))));p.addOptional(<span class="string">'int'</span>, <span class="string">'fast'</span>, @(x)islogical(x) || (ischar(x) &amp;&amp; <spanclass="keyword">...</span>    any(strcmpi(x,{<span class="string">'matlab'</span>,<span class="string">'conv'</span>,<spanclass="string">'fast'</span>})))); <spanclass="comment">% 'ani' not allowed here</span><span class="comment">% parse and validate all input arguments</span>p.parse(varargin{:});p = getvarParser(p);</pre>      <p>checking/setting variables</p>      <pre class="codeinput"><span class="keyword">if</span> size(I,3)~=3    error(<span class="string">'inforgbedge:inputerror'</span>, <span class="string">'matrix (m x n x 3) required in input'</span>);<span class="keyword">end</span>I = rescale(I,0,1);<span class="keyword">if</span> strcmpi(p.reduce,<span class="string">'rgb'</span>)    R = rgb2gray(I);<span class="keyword">elseif</span> strcmpi(p.reduce,<span class="string">'lab'</span>)    C = makecform(<span class="string">'srgb2lab'</span>);    R = applycform(I,C);    R = R(:,:,1);    <span class="comment">% R = rgb2lab(I);</span><span class="keyword">end</span></pre>      <p>main calculations</p>      <pre class="codeinput">[E, M, O, rE, rM, rO] = inforgbedge_base(I, R, p.rho, p.sigma, p.der, p.int);</pre>      <p>display</p>      <pre class="codeinput"><span class="keyword">if</span> p.disp    <span class="comment">%  figure, colormap gray</span>    <span class="comment">%  subplot(1,2,1), imagesc(mag), axis image off, title('multichannel')</span>    <span class="comment">%  subplot(1,2,2), imagesc(rmag), axis image off, title('reduced')</span>    figure,    subplot(1,2,1), imagesc(rescale(cat(3, M, rM, rM),0,1))    title(<span class="string">'magnitude: R multichannel - GB reduced'</span>), axis <spanclass="string">image</span> <spanclass="string">off</span>    subplot(1,2,2), imagesc(rescale(cat(3, E, rE, rE),0,1))    title(<span class="string">'edge map: R multichannel - GB reduced'</span>), axis <spanclass="string">image</span> <spanclass="string">off</span><span class="keyword">end</span></pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of inforgbedge</span></pre> </div>    <!--##### SOURCE BEGIN #####%% INFORGBEDGE - Visualization of edge magnitude and orientation of color images.%%% Description% Provide edge magnitude and orientation of multispectral images based on % their derivatives, using multichannel approach (gradient structure% tensor), and reduced (RGB or LAB) approach (gradient). Used for simple% visual comparison of both approaches.%%% Syntax%     [E, M, O, rE, rM, rO] = INFORGBEDGE(I, 'disp', true);%     [E, M, O, rE, rM, rO] = INFORGBEDGE(I, reduce, rho, sig, der, int);%%% Inputs% *|I|* : an input image with size |(X,Y,C)|, where |C=3| when |I| is multichannel.%   % *|reduce|* : optional string setting the method used for reducing the input%      image into a scalar (graylevel) one; it is either |'rgb'| for calling%      |RGB2GRAY| or |'lab'| for calling |RGB2LAB|; default: |reduce='rgb'|.%      % *|rho|* : optional integration scale (see |GTSMOOTH|); default: |rho=0|, %      ie. in order to compare both multichannel and reduced approaches, we%      skip in principle the spatial averaging of the tensor.%      % *|sig|* : optional differentiation scale (see |GTSMOOTH|); default: |sig=1|,%      i.e. Gaussian regularisation is used for estimating the derivatives.%      % *|der|* : optional string for pre-smoothing/differentiation (see |GRDSMOOTH|):%      |'matlab'|, |'vista'|, |'fast'|, |'conv'|, |'fleck'|, |'tap5'|, |'tap7'|,%      |'sob'|, |'opt'| or |'ana'|; default: |der='matlab'|.%      % *|int|* : optional string for post-smoothing (see |GRD2GST|): |'matlab'|,%      |'conv'| or |'fast'|; default: |int='fast'|.%%% Outputs% *|E, rE|* : edge maps obtained through multichannel and reduced approaches.%      % *|M, O|* : magnitude and orientation using the multichannel approach.%      % *|rM, rO|* : ibid reducing the image first.%% Displays the overlapped gradient magnitudes and edge maps of a color% image using both multispectral and reduced approaches.%%% Credit% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also% Related:% <EDGECORNER.html |EDGECORNER|>,% <KOETHEDGE.html |KOETHEDGE|>,% <CANNYEDGE.html |CANNYEDGE|>.% Called: % <INFORGBEDGE_BASE.html |INFORGBEDGE_BASE|>.%% Function implementationfunction [E, M, O, rE, rM, rO] = inforgbedge(I, varargin)%% % parsing parameterserror(nargchk(1, 19, nargin, 'struct'));error(nargoutchk(0, 4, nargout, 'struct'));% mandatory parameterif ~isnumeric(I)    error('gstsmooth:inputerror','a matrix is required in input'); end% optional parametersp = createParser('GSTSMOOTH');   % principal optional parametersp.addOptional('reduce', 'rgb', @(x)ischar(x) && any(strcmpi(x,{'rgb','lab'})));p.addOptional('rho', 0, @(x)isscalar(x) && isfloat(x) && x>=0);p.addOptional('sigma', 1, @(x)isscalar(x) && isfloat(x) && x>=0);p.addOptional('der', 'matlab', @(x)islogical(x) || (ischar(x) && ...    any(strcmpi(x,{'matlab','vista','fast','conv','fleck', ...    'tap5','tap7','sob','opt','ana'}))));p.addOptional('int', 'fast', @(x)islogical(x) || (ischar(x) && ...    any(strcmpi(x,{'matlab','conv','fast'})))); % 'ani' not allowed here% parse and validate all input argumentsp.parse(varargin{:}); p = getvarParser(p);                                                            %%% checking/setting variablesif size(I,3)~=3    error('inforgbedge:inputerror', 'matrix (m x n x 3) required in input');endI = rescale(I,0,1);if strcmpi(p.reduce,'rgb')    R = rgb2gray(I);elseif strcmpi(p.reduce,'lab')    C = makecform('srgb2lab');    R = applycform(I,C);    R = R(:,:,1);    % R = rgb2lab(I);end%%% main calculations[E, M, O, rE, rM, rO] = inforgbedge_base(I, R, p.rho, p.sigma, p.der, p.int);%%% displayif p.disp    %  figure, colormap gray    %  subplot(1,2,1), imagesc(mag), axis image off, title('multichannel')    %  subplot(1,2,2), imagesc(rmag), axis image off, title('reduced')    figure,    subplot(1,2,1), imagesc(rescale(cat(3, M, rM, rM),0,1))    title('magnitude: R multichannel - GB reduced'), axis image off    subplot(1,2,2), imagesc(rescale(cat(3, E, rE, rE),0,1))    title('edge map: R multichannel - GB reduced'), axis image offendend % end of inforgbedge##### SOURCE END #####-->  </body></html>