<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta content="text/html; charset=utf-8" http-equiv="content-type">    <!--This HTML was auto-generated from MATLAB code.To make changes, update the MATLAB code and republish this document.      -->    <title>MORPHPROFILE - (Derivative) morphological profile by opening and/or      closing.</title>    <meta name="generator" content="MATLAB 7.14">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2012-05-31">    <meta name="DC.source" content="morphprofile.m">    <style type="text/css">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}html { min-height:100%; margin-bottom:1px; }html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }html body td { vertical-align:top; text-align:left; }h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }a { color:#005fce; text-decoration:none; }a:hover { color:#005fce; text-decoration:underline; }a:visited { color:#004aa0; text-decoration:none; }p { padding:0px; margin:0px 0px 20px; }img { padding:0px; margin:0px 0px 20px; border:none; }p img, pre img, tt img, li img { margin-bottom:0px; } ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }ul li { padding:0px; margin:0px 0px 7px 0px; }ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }ul li ol li { list-style:decimal; }ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }ol li ol li { list-style-type:lower-alpha; }ol li ul { padding-top:7px; }ol li ul li { list-style:square; }.content { font-size:1.2em; line-height:140%; padding: 20px; }pre, tt, code { font-size:12px; }pre { margin:0px 0px 20px; }pre.error { color:red; }pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }span.keyword { color:#0000FF }span.comment { color:#228B22 }span.string { color:#A020F0 }span.untermstring { color:#B20000 }span.syscmd { color:#B28C00 }.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }.footer p { margin:0px; }  </style>  </head>  <body>    <div class="content">      <h1>MORPHPROFILE - (Derivative) morphological profile by opening and/or        closing.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Description</a></li>          <li><a href="#2">Syntax</a></li>          <li><a href="#3">Input</a></li>          <li><a href="#4">Outputs</a></li>          <li><a href="#5">References</a></li>          <li><a href="#7">See also</a></li>          <li><a href="#8">Function implementation</a></li>        </ul>      </div>      <h2>Description<a name="1"></a></h2>      <p>Compute the morphological profile, the derivative morphological profile        by opening and closing (or both) and the morphological multiscale        characteristics.</p>      <h2>Syntax<a name="2"></a></h2>      <pre>   DMP = MORPHPROFILE(I);   [DMP, Phi] = MORPHPROFILE(I, op, se);   [DMP, Phi, se, MP] = MORPHPROFILE(I, op, se, s1[, s2]);</pre>      <h2>Input<a name="3"></a></h2>      <p><b><tt>I</tt></b> : input image of size <tt>(X,Y,C)</tt>, with <tt>C&gt;1</tt>        when <tt>I</tt> is multispectral.</p>      <h2>Outputs<a name="4"></a></h2>      <p><b><tt>MP</tt></b> : (derivative of the) morphological profile.</p>      <p><b><tt>Phi</tt></b> : morphological multi-scale characteristics.</p>      <h2>References<a name="5"></a></h2>      <p>[PB00] M. Pesaresi and J.A. Benediktsson: "Image segmentation based on        the derivative of the morphological profile", in Mathematical Morphology        and Its Applications to Image and Signal Processing, J. Goustsias et al.        eds. Norwell (MA, USA), Kluwer, 2000. <a href="http://www.springerlink.com/content/k217533885154776/">http://www.springerlink.com/content/k217533885154776/</a></p>      <p>[PB01] M. Pesaresi and J.A. Benediktsson: "A new approach for the        morphological segmentation of high-resolution satellite imagery", IEEE        Trans. Geosci. Remote Sens., 39(2):309-320, 2001. <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=905239">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=905239</a></p>      <p>[SP02] P. Soille and M. Pesaresi: "Advances in mathematical morphology        applied to geoscience and remote sensing", IEEE Trans. Geosci. Remote        Sens., 40(9):2042-2055, 2002. <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1046853">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1046853</a></p>      <p>[Soille03] P. Soille: "Morphological Image Analysis - Principles and        Applications", 2nd ed. Berlin (Germany), Springer-Verlag, 2003.</p>      <p>[BPA03] J.A. Benediktsson, M. Pesaresi and K. Arnason: "Classification        and feature extraction for remote sensing images from urban areas based        on morphological transformations", IEEE Trans. Geosci. Remote Sens.,        41(9):1940-1949, 2003. <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1232208">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1232208</a></p>      <h2>See also<a name="7"></a></h2>      <p>Related: <a href="matlab:web%28whichpath%28%27WATERSHED%27%29%29"><tt>WATERSHED</tt></a>,        <a href="granulometry.html"><tt>GRANULOMETRY</tt></a>, <a href="asf.html"><tt>ASF</tt></a>.        Called: <a href="morphprofile_base.html"><tt>MORPHPROFILE_BASE</tt></a>.</p>      <h2>Function implementation<a name="8"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> [MP, Phi, varargout] = morphprofile( I, varargin )</pre>      <p>parsing parameters</p>      <pre class="codeinput"><span class="keyword">if</span> isempty(ver(<span class="string">'images'</span>))    error(<span class="string">'morphprofile:errortoolbox'</span>, <span class="string">'Image Processing toolbox required'</span>);<span class="keyword">end</span>error(nargchk(1, 16, nargin, <span class="string">'struct'</span>));error(nargoutchk(1, 4, nargout, <span class="string">'struct'</span>));<span class="keyword">if</span> ~isnumeric(I)    error(<span class="string">'morphprofile:inputparameter'</span>,<span class="string">'a matrix is required in input'</span>);<span class="keyword">end</span>p = createParser(<span class="string">'MORPHPROFILE'</span>);p.addOptional(<span class="string">'op'</span>, <span class="string">'roc'</span>, @(x)ischar(x) &amp;&amp; <spanclass="keyword">...</span>    any(strcmpi(x,{<span class="string">'ro'</span>, <span class="string">'ropen'</span>, <spanclass="string">'rc'</span>, <spanclass="string">'rclose'</span>, <spanclass="string">'roc'</span>,<spanclass="string">'rocmax'</span>, <spanclass="keyword">...</span>    <span class="string">'o'</span>, <span class="string">'open'</span>, <span class="string">'c'</span>, <spanclass="string">'close'</span>, <spanclass="string">'oc'</span>, <spanclass="string">'ocmax'</span>, <spanclass="keyword">...</span>    <span class="string">'e'</span>, <span class="string">'erode'</span>, <spanclass="string">'d'</span>, <spanclass="string">'dilate'</span>, <spanclass="string">'ed'</span>, <spanclass="string">'edmax'</span>})));p.addOptional(<span class="string">'se'</span>, <span class="string">'disk'</span>, @(x) (iscell(x) &amp;&amp; strcmp(class(x{1}),<spanclass="string">'strel'</span>)) || <spanclass="keyword">...</span>    (ischar(x) &amp;&amp; any(strcmpi(x,{<span class="string">'disk'</span>,<spanclass="string">'rectangle'</span>,<spanclass="string">'square'</span>,<spanclass="string">'diamond'</span>, <spanclass="keyword">...</span>                <span class="string">'line'</span>,<span class="string">'periodicline'</span>,<spanclass="string">'arbitrary'</span>,<spanclass="string">'octagon'</span>,<spanclass="string">'pair'</span>}))));p.addParamValue(<span class="string">'s1'</span>, 2:2:10, @(x)isnumeric(x));p.addParamValue(<span class="string">'s2'</span>, [], @(x)isnumeric(x));<span class="comment">% parse and validate all input arguments</span>p.parse(varargin{:});p = getvarParser(p);</pre>      <p>checking/setting variables</p>      <pre class="codeinput">C = size(I,3);<span class="keyword">if</span> ischar(p.se)    shape = p.se;    N = length(p.s1);    <span class="keyword">if</span> ~iscell(p.s1),        <span class="keyword">if</span> any(strcmp(shape,{<span class="string">'disk'</span>}))            p.s1 = floor(p.s1/2);        <span class="keyword">end</span>        p.s1 = num2cell(p.s1);    <span class="keyword">end</span>    <span class="keyword">if</span> ~iscell(p.s2),        <span class="keyword">if</span> isempty(p.s2)            p.s2 = cell(N,1);        <span class="keyword">else</span>            <span class="keyword">if</span> isscalar(p.s2),  p.s2 = repmat(p.s2, 1, N);  <spanclass="keyword">end</span>;            p.s2 = num2cell(p.s2);        <span class="keyword">end</span>    <span class="keyword">end</span>    p.se = cell(N,1);    <span class="keyword">for</span> i=1:N        p.se{i} = flatstrel(shape, p.s1{i}, p.s2{i});    <span class="keyword">end</span><span class="keyword">end</span></pre>      <p>main processing</p>      <pre class="codeinput"><span class="keyword">if</span> nargout==4    [MP, Phi, varargout{2}] = morphprofile_base( I, p.op, p.se );<span class="keyword">else</span>    [MP, Phi] = morphprofile_base( I, p.op, p.se );<span class="keyword">end</span><span class="keyword">if</span> nargout&gt;=3,  varargout{1} = p.se;  <span class="keyword">end</span></pre>      <p>display</p>      <pre class="codeinput"><span class="keyword">if</span> p.disp    <span class="keyword">if</span> any(strcmp(p.op,{<span class="string">'ro'</span>,<spanclass="string">'ropen'</span>})),       p.op = <spanclass="string">'open-by-rec'</span>;    <span class="keyword">elseif</span> any(strcmp(p.op,{<span class="string">'rc'</span>,<spanclass="string">'rclose'</span>})),  p.op = <spanclass="string">'close-by-rec'</span>;    <span class="keyword">elseif</span> strcmp(p.op,<span class="string">'roc'</span>),                 p.op = <spanclass="string">'open- and close-by-rec'</span>;    <span class="keyword">elseif</span> strcmp(p.op,<span class="string">'rocmax'</span>),              p.op = <spanclass="string">'max(open-,close-by-rec)'</span>;    <span class="keyword">elseif</span> any(strcmp(p.op,{<span class="string">'o'</span>,<spanclass="string">'open'</span>})),     p.op = <spanclass="string">'open'</span>;    <span class="keyword">elseif</span> any(strcmp(p.op,{<span class="string">'c'</span>,<spanclass="string">'close'</span>})),    p.op = <spanclass="string">'close'</span>;    <span class="keyword">elseif</span> strcmp(p.op,<span class="string">'oc'</span>),                  p.op = <spanclass="string">'open-close'</span>;    <span class="keyword">elseif</span> strcmp(p.op,<span class="string">'ocmax'</span>),               p.op = <spanclass="string">'max(open,close)'</span>;    <span class="keyword">elseif</span> any(strcmp(p.op,{<span class="string">'e'</span>,<spanclass="string">'erode'</span>})),    p.op = <spanclass="string">'erosion'</span>;    <span class="keyword">elseif</span> any(strcmp(p.op,{<span class="string">'d''dilate'</span>})),    p.op = <spanclass="string">'dilation'</span>;    <span class="keyword">elseif</span> strcmp(p.op,<span class="string">'ed'</span>),                  p.op = <spanclass="string">'erosion-dilation'</span>;    <span class="keyword">elseif</span> strcmp(p.op,<span class="string">'edmax'</span>),               p.op = <spanclass="string">'max(erosion,dilation)'</span>;    <span class="keyword">end</span>    N = length(MP);    <span class="keyword">if</span> any(strcmp(p.op,{<span class="string">'roc'</span>,<spanclass="string">'oc'</span>,<spanclass="string">'ed'</span>})),  N = N/2;  <spanclass="keyword">end</span>    figure; ndisp = 3; mdisp = ceil(N/ndisp);    <span class="keyword">for</span> i=1:N        subplot(mdisp, ndisp, i),  imagesc(rescale(MP{i})), axis <span class="string">image</span> <spanclass="string">off</span>;    <span class="keyword">end</span>    <span class="keyword">if</span> C==1,  colormap <span class="string">gray</span>; <spanclass="keyword">end</span>    <span class="keyword">if</span> any(strcmp(p.op,{<span class="string">'roc'</span>,<spanclass="string">'oc'</span>,<spanclass="string">'ed'</span>}))        figure        <span class="keyword">for</span> i=1:N            subplot(mdisp, ndisp, i),  imagesc(rescale(MP{2*N-i+1})), axis <spanclass="string">image</span> <spanclass="string">off</span>;        <span class="keyword">end</span>        <span class="keyword">if</span> C==1,  colormap <span class="string">gray</span>; <spanclass="keyword">end</span>    <span class="keyword">else</span>        suptitle([<span class="string">'DMP of '</span> p.op]);    <span class="keyword">end</span>    figure, imagesc(rescale(Phi)), axis <span class="string">image</span> <spanclass="string">off</span>, colormap <spanclass="string">gray</span>,    title(<span class="string">'morphological multi-scale characteristics'</span>);<span class="keyword">end</span></pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of morphprofile</span></pre></div>    <!--##### SOURCE BEGIN #####%% MORPHPROFILE - (Derivative) morphological profile by opening and/or closing.%%% Description% Compute the morphological profile, the derivative morphological profile by% opening and closing (or both) and the morphological multiscale characteristics.%%% Syntax%     DMP = MORPHPROFILE(I);%     [DMP, Phi] = MORPHPROFILE(I, op, se);%     [DMP, Phi, se, MP] = MORPHPROFILE(I, op, se, s1[, s2]);%%% Input% *|I|* : input image of size |(X,Y,C)|, with |C>1| when |I| is multispectral.% %% Outputs% *|MP|* : (derivative of the) morphological profile.%% *|Phi|* : morphological multi-scale characteristics.%%% References% [PB00]  M. Pesaresi and J.A. Benediktsson: "Image segmentation based on%      the derivative of the morphological profile", in Mathematical %      Morphology and Its Applications to Image and Signal Processing, %      J. Goustsias et al. eds. Norwell (MA, USA), Kluwer, 2000. %      <http://www.springerlink.com/content/k217533885154776/>%% [PB01]  M. Pesaresi and J.A. Benediktsson: "A new approach for the %      morphological segmentation of high-resolution satellite imagery", %      IEEE Trans. Geosci. Remote Sens., 39(2):309-320, 2001.%      <http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=905239>%% [SP02]  P. Soille and M. Pesaresi: "Advances in mathematical morphology %      applied to geoscience and remote sensing", IEEE Trans. Geosci. Remote %      Sens., 40(9):2042-2055, 2002. %      <http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1046853>%% [Soille03]  P. Soille: "Morphological Image Analysis - Principles and %      Applications", 2nd ed. Berlin (Germany), Springer-Verlag, 2003. %% [BPA03]  J.A. Benediktsson, M. Pesaresi and K. Arnason: "Classification%      and feature extraction for remote sensing images from urban areas based%      on morphological transformations", IEEE Trans. Geosci. Remote Sens.,%      41(9):1940-1949, 2003. %      <http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1232208>%%% Credit% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also% Related:% <matlab:web(whichpath('WATERSHED')) |WATERSHED|>,% <granulometry.html |GRANULOMETRY|>,% <asf.html |ASF|>.% Called:% <morphprofile_base.html |MORPHPROFILE_BASE|>.%% Function implementationfunction [MP, Phi, varargout] = morphprofile( I, varargin )%%% parsing parametersif isempty(ver('images'))    error('morphprofile:errortoolbox', 'Image Processing toolbox required');enderror(nargchk(1, 16, nargin, 'struct'));error(nargoutchk(1, 4, nargout, 'struct'));if ~isnumeric(I)    error('morphprofile:inputparameter','a matrix is required in input'); endp = createParser('MORPHPROFILE');   p.addOptional('op', 'roc', @(x)ischar(x) && ...    any(strcmpi(x,{'ro', 'ropen', 'rc', 'rclose', 'roc','rocmax', ...    'o', 'open', 'c', 'close', 'oc', 'ocmax', ...    'e', 'erode', 'd', 'dilate', 'ed', 'edmax'})));p.addOptional('se', 'disk', @(x) (iscell(x) && strcmp(class(x{1}),'strel')) || ...    (ischar(x) && any(strcmpi(x,{'disk','rectangle','square','diamond', ...                'line','periodicline','arbitrary','octagon','pair'}))));p.addParamValue('s1', 2:2:10, @(x)isnumeric(x));p.addParamValue('s2', [], @(x)isnumeric(x));% parse and validate all input argumentsp.parse(varargin{:}); p = getvarParser(p);                                                            %%% checking/setting variablesC = size(I,3);if ischar(p.se)    shape = p.se;    N = length(p.s1);        if ~iscell(p.s1),        if any(strcmp(shape,{'disk'}))            p.s1 = floor(p.s1/2);        end        p.s1 = num2cell(p.s1);      end    if ~iscell(p.s2),        if isempty(p.s2)            p.s2 = cell(N,1);          else            if isscalar(p.s2),  p.s2 = repmat(p.s2, 1, N);  end;            p.s2 = num2cell(p.s2);         end    end        p.se = cell(N,1);    for i=1:N        p.se{i} = flatstrel(shape, p.s1{i}, p.s2{i});    end    end%%% main processingif nargout==4    [MP, Phi, varargout{2}] = morphprofile_base( I, p.op, p.se );else    [MP, Phi] = morphprofile_base( I, p.op, p.se );endif nargout>=3,  varargout{1} = p.se;  end%%% displayif p.disp        if any(strcmp(p.op,{'ro','ropen'})),       p.op = 'open-by-rec';    elseif any(strcmp(p.op,{'rc','rclose'})),  p.op = 'close-by-rec';    elseif strcmp(p.op,'roc'),                 p.op = 'open- and close-by-rec';    elseif strcmp(p.op,'rocmax'),              p.op = 'max(open-,close-by-rec)';    elseif any(strcmp(p.op,{'o','open'})),     p.op = 'open';    elseif any(strcmp(p.op,{'c','close'})),    p.op = 'close';    elseif strcmp(p.op,'oc'),                  p.op = 'open-close';    elseif strcmp(p.op,'ocmax'),               p.op = 'max(open,close)';    elseif any(strcmp(p.op,{'e','erode'})),    p.op = 'erosion';    elseif any(strcmp(p.op,{'d''dilate'})),    p.op = 'dilation';    elseif strcmp(p.op,'ed'),                  p.op = 'erosion-dilation';    elseif strcmp(p.op,'edmax'),               p.op = 'max(erosion,dilation)';    end        N = length(MP);    if any(strcmp(p.op,{'roc','oc','ed'})),  N = N/2;  end    figure; ndisp = 3; mdisp = ceil(N/ndisp);    for i=1:N        subplot(mdisp, ndisp, i),  imagesc(rescale(MP{i})), axis image off;    end    if C==1,  colormap gray; end    if any(strcmp(p.op,{'roc','oc','ed'}))        figure        for i=1:N            subplot(mdisp, ndisp, i),  imagesc(rescale(MP{2*N-i+1})), axis image off;        end        if C==1,  colormap gray; end    else        suptitle(['DMP of ' p.op]);    end    figure, imagesc(rescale(Phi)), axis image off, colormap gray,    title('morphological multi-scale characteristics');endend % end of morphprofile ##### SOURCE END #####--></body></html>