<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">    <!--This HTML was auto-generated from MATLAB code.To make changes, update the MATLAB code and republish this document.      -->    <title>SLIDEHISTOFUN_BASE - Base function for SLIDEHISTOFUN.</title>    <meta name="generator" content="MATLAB 7.14">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2012-05-31">    <meta name="DC.source" content="slidehistofun_base.m">    <style type="text/css">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}html { min-height:100%; margin-bottom:1px; }html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }html body td { vertical-align:top; text-align:left; }h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }a { color:#005fce; text-decoration:none; }a:hover { color:#005fce; text-decoration:underline; }a:visited { color:#004aa0; text-decoration:none; }p { padding:0px; margin:0px 0px 20px; }img { padding:0px; margin:0px 0px 20px; border:none; }p img, pre img, tt img, li img { margin-bottom:0px; } ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }ul li { padding:0px; margin:0px 0px 7px 0px; }ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }ul li ol li { list-style:decimal; }ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }ol li ol li { list-style-type:lower-alpha; }ol li ul { padding-top:7px; }ol li ul li { list-style:square; }.content { font-size:1.2em; line-height:140%; padding: 20px; }pre, tt, code { font-size:12px; }pre { margin:0px 0px 20px; }pre.error { color:red; }pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }span.keyword { color:#0000FF }span.comment { color:#228B22 }span.string { color:#A020F0 }span.untermstring { color:#B20000 }span.syscmd { color:#B28C00 }.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }.footer p { margin:0px; }  </style>  </head>  <body>    <div class="content">      <h1>SLIDEHISTOFUN_BASE - Base function for SLIDEHISTOFUN.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Syntax</a></li>          <li><a href="#3">See also</a></li>          <li><a href="#4">Function implementation</a></li>        </ul>      </div>      <h2>Syntax<a name="1"></a></h2>      <pre>  O = SLIDEHISTOFUN_BASE(I, method, func, win, bin);</pre>      <h2>See also<a name="3"></a></h2>      <p>Ressembles: <a href="slidehistofun.html"><tt>SLIDEHISTOFUN</tt></a>,        Requires: <a href="integralhisto1d.html"><tt>INTEGRALHISTO1D</tt></a>, <a          href="integralhistojoint.html"><tt>INTEGRALHISTOJOINT</tt></a>,        <a href="matlab:webpub%28whichpath%28%27HISTC%27%29%29"><tt>HISTC</tt></a>.</p>      <h2>Function implementation<a name="4"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> O = slidehistofun_base(I, method, func, win, bin)</pre>      <p>checking/setting the parameters/data</p>      <pre class="codeinput">[X,Y,C] = size(I);                                                     <spanclass="comment">%#ok</span><span class="comment">% if nargin&lt;5,  bin = max(I(:)) + 1;   end</span><span class="comment">% ensure that the window size is odd</span><span class="keyword">if</span> mod(win,2)==0,  win = win + 1;  <span class="keyword">end</span>ws = floor(win / 2); <span class="comment">% half size window</span><span class="keyword">if</span> strcmpi(class(func),<span class="string">'function_handle'</span>),   func = {func};  <spanclass="keyword">end</span>nf = numel(func);<span class="comment">% prepare the output data</span>O = cell(nf,1);<span class="keyword">for</span> i=1:nf,   O{i} = zeros(X,Y);  <span class="keyword">end</span></pre>      <p>initializing function</p>      <pre class="codeinput">inithisto = str2func([<span class="string">'inithisto'</span> method]);<span class="comment">%   %----------------------------------------------------------------------</span>    <span class="keyword">function</span> H = inithistoint(A, dum1, bin)                            <spanclass="comment">%#ok</span>        H = integralhisto1d(A, -bin);        H = padarray( H, [1 1 0], 0, <span class="string">'both'</span>);    <span class="keyword">end</span><span class="comment">%   %----------------------------------------------------------------------</span>    <span class="keyword">function</span> H = inithistojoint(A, dum1, bin)                          <spanclass="comment">%#ok</span>        H = integralhistojoint(A, A, -bin);        H = padarray( H, [1 1 0], 0, <span class="string">'both'</span>);    <span class="keyword">end</span><span class="comment">%   %----------------------------------------------------------------------</span>    <span class="keyword">function</span> cH = inithistodist(A, ws, bin)                            <spanclass="comment">%#ok</span>        <span class="comment">% % initial kernel histogram: count the number of entries accumulated</span>        <span class="comment">% % in each bin</span>        <span class="comment">% H = A(1:2*ws+1,1:2*ws+1);</span>        <span class="comment">% %H = accumarray(H(:), 1, [res 1], @sum);</span>        <span class="comment">% H = hist(H(:),res);</span>        <span class="comment">% column histograms</span>        cH = histc(A(2:2*(ws+1), :), 0:bin-1); <span class="comment">% matrix of size (res,size(A,2))</span>    <span class="keyword">end</span><span class="comment">%   %----------------------------------------------------------------------</span></pre>      <p>sliding function</p>      <pre class="codeinput">slidehisto = str2func([<span class="string">'slidehisto'</span> method]);<span class="comment">%   %----------------------------------------------------------------------</span>    <span class="keyword">function</span> [wh, H] = slidehistoint(A, H, x, Y, ws, bin)              <spanclass="comment">%#ok</span>        wh = zeros(bin,Y);        <span class="keyword">for</span> y=1:Y            wh(:,y) = H(x+1+2*ws,y+1+2*ws,:) - <span class="keyword">...</span>                H(x,y+1+2*ws,:) - H(x+1+2*ws,y,:) + H(x,y,:);        <span class="keyword">end</span>        <span class="comment">% do nothing to H: dummy variable here</span>        <span class="comment">% do not use A: dummy variable</span>    <span class="keyword">end</span><span class="comment">%   %----------------------------------------------------------------------</span>    <span class="keyword">function</span> [wh, H] = slidehistojoint(A, H, x, Y, ws, bin)            <spanclass="comment">%#ok</span>        wh = zeros(bin,Y);        <span class="keyword">for</span> y=1:Y            wh(:,y) = H(x+1+2*ws,y+1+2*ws,:) - <span class="keyword">...</span>                H(x,y+1+2*ws,:) - H(x+1+2*ws,y,:) + H(x,y,:);        <span class="keyword">end</span>        <span class="comment">% do not use A: dummy variable</span>    <span class="keyword">end</span><span class="comment">%   %----------------------------------------------------------------------</span>    <span class="keyword">function</span> [wH, cH] = slidehistodist(A, cH, x, Y, ws, bin)           <spanclass="comment">%#ok</span>        x = x+1;        xx = x+2*ws;        <span class="keyword">if</span> x&gt;1            <span class="comment">% update the (2*ws+1) leftmost column histograms</span>            i0 = (0:2*ws)*bin+A(x-1,1:1+2*ws)+1;  cH(i0) = cH(i0) - 1;            i1 = (0:2*ws)*bin+A(xx,1:1+2*ws)+1;   cH(i1) = cH(i1) + 1;        <span class="keyword">end</span>        <span class="comment">% allocate  the kernel histogram for the current line</span>        wH = zeros(bin,Y);        <span class="comment">% initialize the kernel histogram for the first pixel/neighbourhood</span>        <span class="comment">% with the recently updated (2*ws+1) leftmost column histograms</span>        wH(:,1) = sum(cH(:,1:1+2*ws),2);        <span class="keyword">for</span> y=2:Y            <span class="comment">% update the rightmost column histogram</span>            yy = y+2*ws;            i0 = A(x-1,yy)+1;  cH(i0, yy) = cH(i0, yy) - 1;            i1 = A(xx,yy)+1;   cH(i1, yy) = cH(i1, yy) + 1;            <span class="comment">% update the kernel</span>            wH(:,y) = wH(:,y-1) + cH(:,yy) - cH(:,y-1);        <span class="keyword">end</span>    <span class="keyword">end</span><span class="comment">%   %----------------------------------------------------------------------</span></pre>      <p>computation</p>      <pre class="codeinput"><span class="comment">% pad the input image</span>A = padarray(I, [ws+1 ws+1],<span class="string">'symmetric'</span>,<span class="string">'both'</span>);<span class="comment">% we choose 'symmetric' because it makes the calculation of the kernel</span><span class="comment">% histogram and the column histograms of the first line of the image much</span><span class="comment">% easier</span>H = inithisto(A, ws, bin);<span class="comment">% slide</span><span class="keyword">for</span> x=1:X    [wH, H] = slidehisto(A, H, x, Y, ws, bin);    <span class="keyword">for</span> i=1:nf        O{i}(x,:) = func{i}(wH);    <span class="keyword">end</span><span class="keyword">end</span><span class="keyword">if</span> nf==1,  O = O{1};  <span class="keyword">end</span></pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of slidehistofun_base</span></pre></div>    <!--##### SOURCE BEGIN #####%% SLIDEHISTOFUN_BASE - Base function for SLIDEHISTOFUN.%%% Syntax%    O = SLIDEHISTOFUN_BASE(I, method, func, win, bin);%%% Credit% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also% Ressembles:% <slidehistofun.html |SLIDEHISTOFUN|>,% Requires:% <integralhisto1d.html |INTEGRALHISTO1D|>,% <integralhistojoint.html |INTEGRALHISTOJOINT|>,% <matlab:webpub(whichpath('HISTC')) |HISTC|>.%% Function implementationfunction O = slidehistofun_base(I, method, func, win, bin)%%% checking/setting the parameters/data[X,Y,C] = size(I);                                                     %#ok% if nargin<5,  bin = max(I(:)) + 1;   end% ensure that the window size is oddif mod(win,2)==0,  win = win + 1;  endws = floor(win / 2); % half size windowif strcmpi(class(func),'function_handle'),   func = {func};  endnf = numel(func);% prepare the output dataO = cell(nf,1);for i=1:nf,   O{i} = zeros(X,Y);  end%%% initializing functioninithisto = str2func(['inithisto' method]);%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    function H = inithistoint(A, dum1, bin)                            %#ok        H = integralhisto1d(A, -bin);        H = padarray( H, [1 1 0], 0, 'both');    end%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    function H = inithistojoint(A, dum1, bin)                          %#ok        H = integralhistojoint(A, A, -bin);        H = padarray( H, [1 1 0], 0, 'both');    end%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    function cH = inithistodist(A, ws, bin)                            %#ok        % % initial kernel histogram: count the number of entries accumulated        % % in each bin        % H = A(1:2*ws+1,1:2*ws+1);        % %H = accumarray(H(:), 1, [res 1], @sum);        % H = hist(H(:),res);                % column histograms        cH = histc(A(2:2*(ws+1), :), 0:bin-1); % matrix of size (res,size(A,2))    end%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH%%% sliding functionslidehisto = str2func(['slidehisto' method]);%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    function [wh, H] = slidehistoint(A, H, x, Y, ws, bin)              %#ok                     wh = zeros(bin,Y);        for y=1:Y            wh(:,y) = H(x+1+2*ws,y+1+2*ws,:) - ...                H(x,y+1+2*ws,:) - H(x+1+2*ws,y,:) + H(x,y,:);        end        % do nothing to H: dummy variable here        % do not use A: dummy variable    end%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    function [wh, H] = slidehistojoint(A, H, x, Y, ws, bin)            %#ok        wh = zeros(bin,Y);        for y=1:Y            wh(:,y) = H(x+1+2*ws,y+1+2*ws,:) - ...                H(x,y+1+2*ws,:) - H(x+1+2*ws,y,:) + H(x,y,:);        end        % do not use A: dummy variable    end%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH    function [wH, cH] = slidehistodist(A, cH, x, Y, ws, bin)           %#ok        x = x+1;        xx = x+2*ws;                if x>1            % update the (2*ws+1) leftmost column histograms            i0 = (0:2*ws)*bin+A(x-1,1:1+2*ws)+1;  cH(i0) = cH(i0) - 1;            i1 = (0:2*ws)*bin+A(xx,1:1+2*ws)+1;   cH(i1) = cH(i1) + 1;        end                % allocate  the kernel histogram for the current line        wH = zeros(bin,Y);        % initialize the kernel histogram for the first pixel/neighbourhood        % with the recently updated (2*ws+1) leftmost column histograms        wH(:,1) = sum(cH(:,1:1+2*ws),2);                for y=2:Y            % update the rightmost column histogram            yy = y+2*ws;            i0 = A(x-1,yy)+1;  cH(i0, yy) = cH(i0, yy) - 1;            i1 = A(xx,yy)+1;   cH(i1, yy) = cH(i1, yy) + 1;            % update the kernel            wH(:,y) = wH(:,y-1) + cH(:,yy) - cH(:,y-1);        end    end%   %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH%%% computation% pad the input imageA = padarray(I, [ws+1 ws+1],'symmetric','both'); % we choose 'symmetric' because it makes the calculation of the kernel % histogram and the column histograms of the first line of the image much% easierH = inithisto(A, ws, bin);% slidefor x=1:X    [wH, H] = slidehisto(A, H, x, Y, ws, bin);    for i=1:nf        O{i}(x,:) = func{i}(wH);    endendif nf==1,  O = O{1};  endend % end of slidehistofun_base##### SOURCE END #####--></body></html>