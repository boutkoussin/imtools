<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta content="text/html; charset=utf-8" http-equiv="content-type">    <!--This HTML was auto-generated from MATLAB code.To make changes, update the MATLAB code and republish this document.      -->    <title>EIGENDECOMP2X2SYM - Test function for GSTDECOMP.</title>    <meta name="generator" content="MATLAB 7.11">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2011-07-08">    <meta name="DC.source" content="eigendecomp2x2sym.m">    <style type="text/css">body {  background-color: white;  margin:10px;}h1 {  color: #990000;   font-size: x-large;}h2 {  color: #990000;  font-size: medium;}/* Make the text shrink to fit narrow windows, but not stretch too far in wide windows. */ p,h1,h2,div.content div {  max-width: 600px;  /* Hack for IE6 */  width: auto !important; width: 600px;}pre.codeinput {  background: #EEEEEE;  padding: 10px;}@media print {  pre.codeinput {word-wrap:break-word; width:100%;}} span.keyword {color: #0000FF}span.comment {color: #228B22}span.string {color: #A020F0}span.untermstring {color: #B20000}span.syscmd {color: #B28C00}pre.codeoutput {  color: #666666;  padding: 10px;}pre.error {  color: red;}p.footer {  text-align: right;  font-size: xx-small;  font-weight: lighter;  font-style: italic;  color: gray;}  </style>  </head>  <body>    <div class="content">      <h1>EIGENDECOMP2X2SYM - Test function for GSTDECOMP.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Description</a></li>          <li><a href="#2">Syntax</a></li>          <li><a href="#3">Inputs</a></li>          <li><a href="#4">Outputs</a></li>          <li><a href="#5">Credit</a></li>          <li><a href="#6">See also</a></li>          <li><a href="#7">Function implementation</a></li>        </ul>      </div>      <h2>Description<a name="1"></a></h2>      <p>Check that <tt>GSTDECOMP</tt> returns proper eigenvalues/vectors.        Compare that code with the function <tt>EIGS</tt> implemented in        Matlab.</p>      <h2>Syntax<a name="2"></a></h2>      <pre>   [l1,l2,e1,e2] = EIGENDECOMP2X2SYM(A, method);</pre>      <h2>Inputs<a name="3"></a></h2>      <pre> *|A|* : symmetric |(2,2)| matrix.</pre>      <pre> *|method|* : one method among |'koe', 'kro', 'pey'| or |'eig'|; the method   |'eig'| runs the function EIGS implemented in Matlab.</pre>      <h2>Outputs<a name="4"></a></h2>      <pre> *|[l1,l2,e1,e2]|* : output eigenvalues/vectors.</pre>      <h2>See also<a name="6"></a></h2>      <p>Related: <a href="GSTDECOMP.html"><tt>GSTDECOMP</tt></a>. Called: <a          href="matlab:webpub%28whichpath%28%27EIGS%27%29%29"><tt>EIGS</tt></a>.</p>      <h2>Function implementation<a name="7"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> [l1,l2,e1,e2] = eigendecomp2x2sym(A, method)</pre>      <pre class="codeinput">gx2 = A(1,1);gy2 = A(2,2);gxy = A(1,2);<span class="keyword">if</span> A(2,1)~=gxy,    error(<span class="string">'eigendecomp2x2sym:inputerror'</span>,<span class="string">'symmetric matrix expected'</span>);<span class="keyword">elseif</span> ~any(strcmpi(method,{<span class="string">'koe'</span>,<spanclass="string">'kro'</span>,<spanclass="string">'pey'</span>,<spanclass="string">'eig'</span>}));    error(<span class="string">'eigendecomp2x2sym:inputerror'</span>,<span class="keyword">...</span>        <span class="string">'choose one method among ''koe'', ''kro'', ''pey'' or ''eig'''</span>)<span class="keyword">end</span></pre>      <div>        <ul>          <li>output given by Matlab</li>        </ul>      </div>      <pre class="codeinput"><span class="comment">% run Matlab internal function</span><span class="keyword">if</span> strcmpi(method,<span class="string">'eig'</span>)    [V,D] = eigs(A);    l1 = D(1); l2 = D(4);    e1 = V(:,1)'; e2 = V(:,2)';    <span class="keyword">return</span><span class="keyword">end</span></pre>      <div>        <ul>          <li>output given by the function GSTDECOMP. This is a copy paste of            the code in that function</li>        </ul>      </div>      <pre class="codeinput"><span class="keyword">if</span> strcmpi(method,<spanclass="string">'pey'</span>)    <span class="comment">% another expression for eigenvalues</span>    t = 0.5 * (gx2+gy2);     <span class="comment">% trace/2</span>    a = gx2 - t;  <span class="comment">% a = 0.5 * (gx2-gy2);</span>    ab2 = sqrt(a.^2 + gxy.^2); <span class="comment">% we have root = 2 * ab2; (see above)</span>    l1 = t + ab2;    l2 = t - ab2;<span class="keyword">elseif</span> any(strcmpi(method,{<span class="string">'koe'</span>,<spanclass="string">'kro'</span>}))    <span class="comment">% VIGRA expression: see file tensorutilities.hxx, function</span>    <span class="comment">% tensorEigenRepresentation</span>    <span class="comment">% Kroon expression: see file EigenVectors2D.m</span>    d1 = gx2 + gy2; <span class="comment">%src.getComponent(s,0) + src.getComponent(s,2);</span>    d2 = gx2 - gy2; <span class="comment">%src.getComponent(s,0) - src.getComponent(s,2);</span>    d3 = 2 * gxy;   <span class="comment">%2.0 * src.getComponent(s,1);</span>    d4 = sqrt(d2.^2 + d3.^2); <span class="comment">% hypot(d2, d3)</span>    <span class="comment">% root = d4;</span>    l1 = 0.5 * (d1+d4); <span class="comment">%dest.setComponent(0.5 * (d1 + d4), d, 0);</span>    l2 = 0.5 * (d1-d4); <span class="comment">%dest.setComponent(0.5 * (d1 - d4), d, 1);</span><span class="keyword">end</span><span class="keyword">if</span> strcmpi(method,<span class="string">'koe'</span>)    <span class="comment">% double angle representation: theta in [-pi/2,pi/2]</span>    <span class="comment">%    %theta = gstfeature(gx2, gy2, gxy, 'orient');</span>    theta = 0.5 * atan2(d3, d2);    <span class="comment">%dest.setComponent(0.5 * VIGRA_CSTD::atan2(d3, d2), d, 2);</span>    <span class="comment">% note: atan2(0,0)=0</span>    <span class="comment">% principal eigen vector</span>    e1(1) = cos(theta);    e1(2) = sin(theta);<span class="keyword">elseif</span> strcmpi(method,<span class="string">'pey'</span>)    <span class="comment">% atan2 expression for orientation: atan2(l1-gx2,gxy)</span>    theta = atan2( ab2-a, gxy );    e1(1) = cos(theta);    e1(2) = sin(theta);<span class="keyword">elseif</span> strcmpi(method,<span class="string">'kro'</span>)    <span class="comment">% note: no theta computed here</span>    vx = d3;    vy = d4 - d2;    mag = sqrt(vx.^2 + vy.^2);    i = (mag ~= 0);    vx(i) = vx(i)./mag(i);    vy(i) = vy(i)./mag(i);    e1(1) = vx;    e1(2) = vy;<span class="keyword">end</span><span class="comment">%  eigenvectors are orthogonal</span>e2(1) = -e1(2);e2(2) = e1(1);</pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of eigendecomp2x2sym</span></pre>      <p class="footer"><br>      </p>    </div>    <!--##### SOURCE BEGIN #####%% EIGENDECOMP2X2SYM - Test function for GSTDECOMP.%%% Description% Check that |GSTDECOMP| returns proper eigenvalues/vectors. Compare that code% with the function |EIGS| implemented in Matlab.%%% Syntax%     [l1,l2,e1,e2] = EIGENDECOMP2X2SYM(A, method);%%% Inputs%   *|A|* : symmetric |(2,2)| matrix.%%   *|method|* : one method among |'koe', 'kro', 'pey'| or |'eig'|; the method%     |'eig'| runs the function EIGS implemented in Matlab.%%% Outputs%   *|[l1,l2,e1,e2]|* : output eigenvalues/vectors.%%% Credit% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also  % Related:% <GSTDECOMP.html |GSTDECOMP|>.% Called:% <matlab:webpub(whichpath('EIGS')) |EIGS|>.%% Function implementationfunction [l1,l2,e1,e2] = eigendecomp2x2sym(A, method)gx2 = A(1,1);gy2 = A(2,2);gxy = A(1,2);if A(2,1)~=gxy,      error('eigendecomp2x2sym:inputerror','symmetric matrix expected');elseif ~any(strcmpi(method,{'koe','kro','pey','eig'}));    error('eigendecomp2x2sym:inputerror',...        'choose one method among ''koe'', ''kro'', ''pey'' or ''eig''')end%% % * output given by Matlab% run Matlab internal functionif strcmpi(method,'eig')    [V,D] = eigs(A);    l1 = D(1); l2 = D(4);    e1 = V(:,1)'; e2 = V(:,2)';    returnend%% % * output given by the function GSTDECOMP. This is a copy paste of the code% in that functionif strcmpi(method,'pey')    % another expression for eigenvalues    t = 0.5 * (gx2+gy2);     % trace/2    a = gx2 - t;  % a = 0.5 * (gx2-gy2);    ab2 = sqrt(a.^2 + gxy.^2); % we have root = 2 * ab2; (see above)    l1 = t + ab2;    l2 = t - ab2;    elseif any(strcmpi(method,{'koe','kro'}))    % VIGRA expression: see file tensorutilities.hxx, function    % tensorEigenRepresentation    % Kroon expression: see file EigenVectors2D.m    d1 = gx2 + gy2; %src.getComponent(s,0) + src.getComponent(s,2);    d2 = gx2 - gy2; %src.getComponent(s,0) - src.getComponent(s,2);    d3 = 2 * gxy;   %2.0 * src.getComponent(s,1);    d4 = sqrt(d2.^2 + d3.^2); % hypot(d2, d3)    % root = d4;    l1 = 0.5 * (d1+d4); %dest.setComponent(0.5 * (d1 + d4), d, 0);    l2 = 0.5 * (d1-d4); %dest.setComponent(0.5 * (d1 - d4), d, 1);endif strcmpi(method,'koe')    % double angle representation: theta in [-pi/2,pi/2]    %    %theta = gstfeature(gx2, gy2, gxy, 'orient');    theta = 0.5 * atan2(d3, d2);    %dest.setComponent(0.5 * VIGRA_CSTD::atan2(d3, d2), d, 2);    % note: atan2(0,0)=0    % principal eigen vector    e1(1) = cos(theta);    e1(2) = sin(theta);    elseif strcmpi(method,'pey')    % atan2 expression for orientation: atan2(l1-gx2,gxy)    theta = atan2( ab2-a, gxy );    e1(1) = cos(theta);    e1(2) = sin(theta);    elseif strcmpi(method,'kro')    % note: no theta computed here    vx = d3;    vy = d4 - d2;    mag = sqrt(vx.^2 + vy.^2);    i = (mag ~= 0);    vx(i) = vx(i)./mag(i);    vy(i) = vy(i)./mag(i);        e1(1) = vx;    e1(2) = vy;end%  eigenvectors are orthogonale2(1) = -e1(2);e2(2) = e1(1);end % end of eigendecomp2x2sym##### SOURCE END #####-->  </body></html>