<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html>  <head>    <meta content="text/html; charset=utf-8" http-equiv="content-type">    <!--This HTML was auto-generated from MATLAB code.To make changes, update the MATLAB code and republish this document.      -->    <title>EIGENDECOMP2X2SYM - Test function for GSTDECOMP.</title>    <meta name="generator" content="MATLAB 7.14">    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">    <meta name="DC.date" content="2012-11-14">    <meta name="DC.source" content="eigendecomp2x2sym.m">    <style type="text/css">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}html { min-height:100%; margin-bottom:1px; }html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }html body td { vertical-align:top; text-align:left; }h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }a { color:#005fce; text-decoration:none; }a:hover { color:#005fce; text-decoration:underline; }a:visited { color:#004aa0; text-decoration:none; }p { padding:0px; margin:0px 0px 20px; }img { padding:0px; margin:0px 0px 20px; border:none; }p img, pre img, tt img, li img { margin-bottom:0px; } ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }ul li { padding:0px; margin:0px 0px 7px 0px; }ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }ul li ol li { list-style:decimal; }ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }ol li ol li { list-style-type:lower-alpha; }ol li ul { padding-top:7px; }ol li ul li { list-style:square; }.content { font-size:1.2em; line-height:140%; padding: 20px; }pre, tt, code { font-size:12px; }pre { margin:0px 0px 20px; }pre.error { color:red; }pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }span.keyword { color:#0000FF }span.comment { color:#228B22 }span.string { color:#A020F0 }span.untermstring { color:#B20000 }span.syscmd { color:#B28C00 }.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }.footer p { margin:0px; }  </style>  </head>  <body>    <div class="content">      <h1>EIGENDECOMP2X2SYM - Test function for GSTDECOMP.</h1>      <!--introduction--><!--/introduction-->      <h2>Contents</h2>      <div>        <ul>          <li><a href="#1">Description</a></li>          <li><a href="#2">Syntax</a></li>          <li><a href="#3">Inputs</a></li>          <li><a href="#4">Outputs</a></li>          <li><a href="#6">See also</a></li>          <li><a href="#7">Function implementation</a></li>        </ul>      </div>      <h2>Description<a name="1"></a></h2>      <p>Check that <tt>GSTDECOMP</tt> returns proper eigenvalues/vectors.        Compare that code with the function <tt>EIGS</tt> implemented in        Matlab.</p>      <h2>Syntax<a name="2"></a></h2>      <pre>   [l1,l2,e1,e2] = EIGENDECOMP2X2SYM(A, method);</pre>      <h2>Inputs<a name="3"></a></h2>      <pre class="language-matlab">*|A|* : symmetric |(2,2)| matrix.</pre>      <pre class="language-matlab">*|method|* : one method <span class="string">among</span> <spanclass="string">|'koe'</span>, <spanclass="string">'kro'</span>, <spanclass="string">'pey'</span>| or |<spanclass="string">'eig'</span>|; the <spanclass="string">method</span>  |<span class="string">'eig'</span>| runs the <span class="string">function</span> <spanclass="string">EIGS</span> <spanclass="string">implemented</span> <spanclass="string">in</span> <spanclass="string">Matlab.</span></pre>      <h2>Outputs<a name="4"></a></h2>      <pre class="language-matlab">*|[l1,l2,e1,e2]|* : output eigenvalues/vectors.</pre>      <h2>See also<a name="6"></a></h2>      <p>Related: <a href="GSTDECOMP.html"><tt>GSTDECOMP</tt></a>. Called: <a          href="matlab:webpub%28whichpath%28%27EIGS%27%29%29"><tt>EIGS</tt></a>.</p>      <h2>Function implementation<a name="7"></a></h2>      <pre class="codeinput"><span class="keyword">function</span> [l1,l2,e1,e2] = eigendecomp2x2sym(A, method)</pre>      <pre class="codeinput">gx2 = A(1,1);gy2 = A(2,2);gxy = A(1,2);<span class="keyword">if</span> A(2,1)~=gxy,    error(<span class="string">'eigendecomp2x2sym:inputerror'</span>,<span class="string">'symmetric matrix expected'</span>);<span class="keyword">elseif</span> ~any(strcmpi(method,{<span class="string">'koe'</span>,<spanclass="string">'kro'</span>,<spanclass="string">'pey'</span>,<spanclass="string">'eig'</span>}));    error(<span class="string">'eigendecomp2x2sym:inputerror'</span>,<span class="keyword">...</span>        <span class="string">'choose one method among ''koe'', ''kro'', ''pey'' or ''eig'''</span>)<span class="keyword">end</span></pre>      <div>        <ul>          <li>output given by Matlab</li>        </ul>      </div>      <pre class="codeinput"><span class="comment">% run Matlab internal function</span><span class="keyword">if</span> strcmpi(method,<span class="string">'eig'</span>)    [V,D] = eigs(A);    l1 = D(1); l2 = D(4);    e1 = V(:,1)'; e2 = V(:,2)';    <span class="keyword">return</span><span class="keyword">end</span></pre>      <div>        <ul>          <li>output given by the function GSTDECOMP. This is a copy paste of            the code in that function</li>        </ul>      </div>      <pre class="codeinput"><span class="keyword">if</span> strcmpi(method,<spanclass="string">'pey'</span>)    <span class="comment">% another expression for eigenvalues</span>    t = 0.5 * (gx2+gy2);     <span class="comment">% trace/2</span>    a = gx2 - t;  <span class="comment">% a = 0.5 * (gx2-gy2);</span>    ab2 = sqrt(a.^2 + gxy.^2); <span class="comment">% we have root = 2 * ab2; (see above)</span>    l1 = t + ab2;    l2 = t - ab2;<span class="keyword">elseif</span> any(strcmpi(method,{<span class="string">'koe'</span>,<spanclass="string">'kro'</span>}))    <span class="comment">% VIGRA expression: see file tensorutilities.hxx, function</span>    <span class="comment">% tensorEigenRepresentation</span>    <span class="comment">% Kroon expression: see file EigenVectors2D.m</span>    d1 = gx2 + gy2; <span class="comment">%src.getComponent(s,0) + src.getComponent(s,2);</span>    d2 = gx2 - gy2; <span class="comment">%src.getComponent(s,0) - src.getComponent(s,2);</span>    d3 = 2 * gxy;   <span class="comment">%2.0 * src.getComponent(s,1);</span>    d4 = sqrt(d2.^2 + d3.^2); <span class="comment">% hypot(d2, d3)</span>    <span class="comment">% root = d4;</span>    l1 = 0.5 * (d1+d4); <span class="comment">%dest.setComponent(0.5 * (d1 + d4), d, 0);</span>    l2 = 0.5 * (d1-d4); <span class="comment">%dest.setComponent(0.5 * (d1 - d4), d, 1);</span><span class="keyword">end</span><span class="keyword">if</span> strcmpi(method,<span class="string">'koe'</span>)    <span class="comment">% double angle representation: theta in [-pi/2,pi/2]</span>    <span class="comment">%    %theta = gstfeature(gx2, gy2, gxy, 'orient');</span>    theta = 0.5 * atan2(d3, d2);    <span class="comment">%dest.setComponent(0.5 * VIGRA_CSTD::atan2(d3, d2), d, 2);</span>    <span class="comment">% note: atan2(0,0)=0</span>    <span class="comment">% principal eigen vector</span>    e1(1) = cos(theta);    e1(2) = sin(theta);<span class="keyword">elseif</span> strcmpi(method,<span class="string">'pey'</span>)    <span class="comment">% atan2 expression for orientation: atan2(l1-gx2,gxy)</span>    theta = atan2( ab2-a, gxy );    e1(1) = cos(theta);    e1(2) = sin(theta);<span class="keyword">elseif</span> strcmpi(method,<span class="string">'kro'</span>)    <span class="comment">% note: no theta computed here</span>    vx = d3;    vy = d4 - d2;    mag = sqrt(vx.^2 + vy.^2);    i = (mag ~= 0);    vx(i) = vx(i)./mag(i);    vy(i) = vy(i)./mag(i);    e1(1) = vx;    e1(2) = vy;<span class="keyword">end</span><span class="comment">%  eigenvectors are orthogonal</span>e2(1) = -e1(2);e2(2) = e1(1);</pre>      <pre class="codeinput"><span class="keyword">end</span> <span class="comment">% end of eigendecomp2x2sym</span></pre></div>    <!--##### SOURCE BEGIN #####%% EIGENDECOMP2X2SYM - Test function for GSTDECOMP.%%% Description% Check that |GSTDECOMP| returns proper eigenvalues/vectors. Compare that code% with the function |EIGS| implemented in Matlab.%%% Syntax%     [l1,l2,e1,e2] = EIGENDECOMP2X2SYM(A, method);%%% Inputs%   *|A|* : symmetric |(2,2)| matrix.%%   *|method|* : one method among |'koe', 'kro', 'pey'| or |'eig'|; the method%     |'eig'| runs the function EIGS implemented in Matlab.%%% Outputs%   *|[l1,l2,e1,e2]|* : output eigenvalues/vectors.%%% Credit% <mailto:grazzja@lanl.gov J.Grazzini> (ISR-2/LANL)%%% See also  % Related:% <GSTDECOMP.html |GSTDECOMP|>.% Called:% <matlab:webpub(whichpath('EIGS')) |EIGS|>.%% Function implementationfunction [l1,l2,e1,e2] = eigendecomp2x2sym(A, method)gx2 = A(1,1);gy2 = A(2,2);gxy = A(1,2);if A(2,1)~=gxy,      error('eigendecomp2x2sym:inputerror','symmetric matrix expected');elseif ~any(strcmpi(method,{'koe','kro','pey','eig'}));    error('eigendecomp2x2sym:inputerror',...        'choose one method among ''koe'', ''kro'', ''pey'' or ''eig''')end%% % * output given by Matlab% run Matlab internal functionif strcmpi(method,'eig')    [V,D] = eigs(A);    l1 = D(1); l2 = D(4);    e1 = V(:,1)'; e2 = V(:,2)';    returnend%% % * output given by the function GSTDECOMP. This is a copy paste of the code% in that functionif strcmpi(method,'pey')    % another expression for eigenvalues    t = 0.5 * (gx2+gy2);     % trace/2    a = gx2 - t;  % a = 0.5 * (gx2-gy2);    ab2 = sqrt(a.^2 + gxy.^2); % we have root = 2 * ab2; (see above)    l1 = t + ab2;    l2 = t - ab2;    elseif any(strcmpi(method,{'koe','kro'}))    % VIGRA expression: see file tensorutilities.hxx, function    % tensorEigenRepresentation    % Kroon expression: see file EigenVectors2D.m    d1 = gx2 + gy2; %src.getComponent(s,0) + src.getComponent(s,2);    d2 = gx2 - gy2; %src.getComponent(s,0) - src.getComponent(s,2);    d3 = 2 * gxy;   %2.0 * src.getComponent(s,1);    d4 = sqrt(d2.^2 + d3.^2); % hypot(d2, d3)    % root = d4;    l1 = 0.5 * (d1+d4); %dest.setComponent(0.5 * (d1 + d4), d, 0);    l2 = 0.5 * (d1-d4); %dest.setComponent(0.5 * (d1 - d4), d, 1);endif strcmpi(method,'koe')    % double angle representation: theta in [-pi/2,pi/2]    %    %theta = gstfeature(gx2, gy2, gxy, 'orient');    theta = 0.5 * atan2(d3, d2);    %dest.setComponent(0.5 * VIGRA_CSTD::atan2(d3, d2), d, 2);    % note: atan2(0,0)=0    % principal eigen vector    e1(1) = cos(theta);    e1(2) = sin(theta);    elseif strcmpi(method,'pey')    % atan2 expression for orientation: atan2(l1-gx2,gxy)    theta = atan2( ab2-a, gxy );    e1(1) = cos(theta);    e1(2) = sin(theta);    elseif strcmpi(method,'kro')    % note: no theta computed here    vx = d3;    vy = d4 - d2;    mag = sqrt(vx.^2 + vy.^2);    i = (mag ~= 0);    vx(i) = vx(i)./mag(i);    vy(i) = vy(i)./mag(i);        e1(1) = vx;    e1(2) = vy;end%  eigenvectors are orthogonale2(1) = -e1(2);e2(2) = e1(1);end % end of eigendecomp2x2sym##### SOURCE END #####-->  </body></html>